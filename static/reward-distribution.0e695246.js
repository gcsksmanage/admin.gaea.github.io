import{d as A,r as E,e as I,R as T,o as p,c as w,b as V,f as d,w as n,u as a,v as g,q as v,J as U,K as N,g as f,E as c,h as q,i as C,P as j,j as z,k as P,l as G,t as R,p as J,a as K,O as L,_ as H}from"./entry.15a76552.js";/* empty css                 *//* empty css                *//* empty css                       *//* empty css                        *//* empty css                  */import{G as M,H as O,I as Q,J as W,K as X,L as Y}from"./adminManage.c8246d07.js";import{t as Z}from"./throttle.46d02480.js";import"./request.72540ff6.js";const ee=m=>(J("data-v-28f57ce0"),m=m(),K(),m),te={class:"w-full h-full overflow-auto"},re={class:"w-fit h-full text-[#EBEBEB] pl-10 mt-10"},le=ee(()=>V("p",{class:"text-red-500 text-[12px] ml-24 mb-2"},"注：多个账户用逗号隔开",-1)),ae={class:"w-full flex justify-end"},oe=A({__name:"reward-distribution",setup(m){const b=E(),B=[{value:1,key:1,label:"snft"},{value:2,key:2,label:"anft"},{value:3,key:3,label:"milestone"},{value:4,key:4,label:"audioVisual"},{value:5,key:5,label:"event"}],x=[{value:"points",key:"points",label:"积分",api:M,min:1,max:1e4},{value:"soul",key:"soul",label:"心灵点",api:O,min:1,max:500},{value:"number",key:"blindbox",label:"盲盒",api:Q,min:1,max:200},{value:"number",key:"ticketbox",label:"票盒",api:W,min:1,max:200},{value:"sxp",key:"sxp",label:"sxp",api:r=>{if(r.addrs&&r.addrs.trim()!==""){const t=r.addrs.split(",").map(l=>l.trim()).join(","),s={};return r.addrs.split(",").forEach(l=>{s[l.trim()]=Number(r.sxp)}),X({airdrop_type:r.airdrop_type||0,airdrop_task:r.airdrop_task||"",addrs:t,sxp:Number(r.sxp),addr_sxp_map:s})}else{const t={};return r.uids.split(",").forEach(s=>{t[s.trim()]=Number(r.sxp)}),Y({airdrop_type:r.airdrop_type||0,airdrop_task:r.airdrop_task||"",uids:r.uids,sxp:Number(r.sxp),user_sxp_map:t})}},min:1,max:1e4}],D=I({uids:[{required:!0,message:"请输入用户ID",trigger:"blur"},{validator:(r,t,s)=>{if(!t.trim()){s(new Error("请输入用户ID"));return}const l=t.split(",").map(i=>i.trim());for(const i of l){if(!/^\d+$/.test(i)){s(new Error("UID 格式错误，必须为数字"));return}if(i.length!==14){s(new Error("UID 长度必须为14位"));return}}s()},trigger:"blur"}],airdrop_task:[{required:!0,message:"请输入活动类型",trigger:"blur"}],num:[{required:!0,message:"请输入",trigger:"blur"},{validator:(r,t,s)=>{const l=x.find(i=>i.key===e.type);l&&(t<l.min||t>l.max)?s(new Error(`${l.label}数应在 ${l.min} 到 ${l.max} 之间`)):s()},trigger:"blur"}],type:[{required:!0,message:"请选择奖励类型",trigger:"change"}]}),_=E(!1),e=I({uids:"",addrs:"",type:"points",num:1,points:null,soul:null,sxp:null,blindbox:null,ticketbox:null,description:"",airdrop_type:"",airdrop_task:""});T(()=>e.type,r=>{r!==void 0&&(e.num=1)});const h=r=>{r&&r.resetFields()},$=async r=>{r&&(_.value||await r.validate(async(t,s)=>{if(!t)return;const l=x.find(i=>i.key===e.type);if(!l){c.error("未找到对应的奖励类型");return}try{_.value=!0;let i;if(e.type==="sxp"){const u={uids:e.uids,addrs:e.addrs,sxp:e.num,airdrop_type:e.airdrop_type,airdrop_task:e.airdrop_task};i=await l.api(u)}else{const k={uids:e.uids.split(",").map(y=>`${y.trim()}`).join(","),[l.value]:Number(e.num)};i=await l.api(k)}i.code===200?c.success(`${l.label}奖励发放成功,${i.data}`):c.error(i.msg||"奖励发放失败")}catch{c.error("奖励发放失败，请稍后再试")}finally{_.value=!1,h(r)}}))};return(r,t)=>{const s=q,l=C,i=L,u=j,k=z,y=P,F=G;return p(),w("div",te,[V("div",re,[d(F,{ref_key:"ruleFormRef",ref:b,inline:!0,"label-position":"right","label-width":"90px",model:a(e),rules:a(D),class:"flex flex-col w-fit"},{default:n(()=>[le,d(l,{label:"用户ID:",class:"w-[705px]"},{default:n(()=>[d(s,{type:"textarea",autosize:{minRows:2,maxRows:25},style:{width:"100%"},"controls-position":"right",modelValue:a(e).uids,"onUpdate:modelValue":t[0]||(t[0]=o=>a(e).uids=o),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),a(e).type==="sxp"?(p(),g(l,{key:0,label:"钱包地址:",prop:"addrs",class:"w-[470px]"},{default:n(()=>[d(s,{autosize:"",type:"textarea",style:{width:"100%"},"controls-position":"right",modelValue:a(e).addrs,"onUpdate:modelValue":t[1]||(t[1]=o=>a(e).addrs=o),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1})):v("",!0),d(l,{label:"奖励:",prop:"type"},{default:n(()=>[d(u,{modelValue:a(e).type,"onUpdate:modelValue":t[2]||(t[2]=o=>a(e).type=o)},{default:n(()=>[(p(),w(U,null,N(x,(o,S)=>d(i,{label:o.key,key:o.key},{default:n(()=>[f(R(o.label),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),a(e).type==="sxp"?(p(),g(l,{key:1,label:"补发类型:",prop:"type"},{default:n(()=>[d(u,{modelValue:a(e).airdrop_type,"onUpdate:modelValue":t[3]||(t[3]=o=>a(e).airdrop_type=o)},{default:n(()=>[(p(),w(U,null,N(B,(o,S)=>d(i,{label:o.key,key:o.key},{default:n(()=>[f(R(o.label),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1})):v("",!0),a(e).type==="sxp"&&a(e).airdrop_type===3||a(e).airdrop_type===4||a(e).airdrop_type===5?(p(),g(l,{key:2,label:"活动类型:",prop:"airdrop_task"},{default:n(()=>[d(s,{autosize:"",style:{width:"100%"},"controls-position":"right",modelValue:a(e).airdrop_task,"onUpdate:modelValue":t[4]||(t[4]=o=>a(e).airdrop_task=o),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1})):v("",!0),d(l,{label:"数量:",prop:"num",class:"w-[350px]"},{default:n(()=>[d(k,{min:1,max:1e4,"controls-position":"right",modelValue:a(e).num,"onUpdate:modelValue":t[5]||(t[5]=o=>a(e).num=o),placeholder:"请输入",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),V("div",ae,[d(y,{class:"w-[20%]",type:"danger",onClick:t[6]||(t[6]=o=>h(a(b)))},{default:n(()=>[f(" 重置 ")]),_:1}),d(y,{class:"w-[20%]",type:"success",loading:a(_),onClick:t[7]||(t[7]=o=>("throttle"in r?r.throttle:a(Z))(()=>{$(a(b))}))},{default:n(()=>[f(" 发放 ")]),_:1},8,["loading"])])]),_:1},8,["model","rules"])])])}}});const ce=H(oe,[["__scopeId","data-v-28f57ce0"]]);export{ce as default};
