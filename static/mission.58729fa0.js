import{d as M,r as b,e as k,o as T,c as F,f as l,w as a,b as C,t as D,u as o,v as L,g as m,q as S,E as V,O as B,P as j,i as q,h as I,j as O,k as z,l as G,m as W,_ as X,n as Y,s as Q,C as H,x as J,y as K,z as Z,A as ee,B as te}from"./entry.89aa1c3d.js";import{_ as le}from"./client-only.690704d1.js";/* empty css                       *//* empty css                *//* empty css                 *//* empty css                        *//* empty css                  *//* empty css                   */import{v as oe,x as ae,y as se,z as re}from"./adminManage.ae1f3a84.js";import{t as ne}from"./throttle.46d02480.js";/* empty css                 *//* empty css               *//* empty css                */import"./el-tooltip.4ed993c7.js";/* empty css                     *//* empty css                      *//* empty css                  *//* empty css                   */import"./request.c7cf0d48.js";const ie={class:"text-[#ebebeb] text-[16px]"},de={class:"w-full flex justify-end"},ue=M({__name:"Add",props:{dialogVisible:{type:Boolean,default:!1},item:{default:{}}},emits:["update:closeDialog","update:success"],setup(U,{emit:c}){const r=U,g=b(!1),e=k({id:null,code:"RETWEET_X",title:"",description:"",url:"",points:null,soul:null,order:1,mark:1,status:1,rewardType:1,rewardNum:1}),f=b(),_=k({title:[{required:!0,message:"Please enter",trigger:"blur"}],description:[{required:!0,message:"Please enter",trigger:"blur"}],url:[{required:!0,message:"Please enter",trigger:"blur"},{validator:(s,t,u)=>{if(/%(?:2[1-9a-fA-F]|[3-6][0-9a-fA-F]|7[0-9a-eA-E])|[<>'"\\\x00-\x1F\x7F]/.test(t))return u(new Error("URL cannot contain any escape characters"));if(!/^(https?|ftp):\/\/[^\s/$.?#].[^\s]*$/i.test(t))return u(new Error("Please enter a valid URL"));u()},trigger:"blur"}],rewardNum:[{required:!0,message:"Please enter",trigger:"blur"}]}),w=s=>{s&&s.resetFields()},P=async s=>{s&&(g.value||await s.validate(async(t,u)=>{if(t)try{g.value=!0;const d={...e,id:r.item.id,points:e.rewardType===1?e.rewardNum:0,soul:e.rewardType===2?e.rewardNum:0};var n=null;r.item.id?(delete d.code,n=await oe(d)):(delete d.id,n=await ae(d)),n.code===200?(V.success({message:"Created successfully",grouping:!0,type:"success"}),c("update:success"),y()):V.error({message:n.msg,grouping:!0,type:"error"})}catch{}finally{g.value=!1,w(s)}}))},y=()=>{c("update:closeDialog"),w(f.value)},N=async()=>{r.item.id?(e.id=r.item.id,e.title=r.item.title,e.description=r.item.description,e.url=r.item.url,e.order=r.item.order,e.mark=r.item.mark,e.status=r.item.status,e.rewardNum=r.item.points>0?r.item.points:r.item.soul,e.rewardType=r.item.points>0?1:2):(e.id=null,e.code="RETWEET_X",e.title="",e.description="",e.url="",e.order=1,e.mark=1,e.status=1,e.rewardType=1,e.rewardNum=0)};return(s,t)=>{const u=B,n=j,d=q,v=I,x=O,E=z,R=G,p=W,$=le;return T(),F("div",null,[l($,null,{default:a(()=>[l(p,{draggable:"","model-value":s.$props.dialogVisible,style:{"background-color":"black",border:"1px  #ebebeb solid","border-radius":"10px","padding-bottom":"30px"},title:"",width:"550px",class:"px-10","align-center":"",onClose:y,onOpen:t[11]||(t[11]=A=>N())},{default:a(()=>{var A;return[C("p",ie,D((A=o(e))!=null&&A.id?"Edit Mission":"Create Mission"),1),l(R,{ref_key:"ruleFormRef",ref:f,class:"w-full p-5",inline:!0,"label-position":"right","label-width":"140px",model:o(e),rules:o(_)},{default:a(()=>{var h;return[(h=o(e))!=null&&h.id?S("",!0):(T(),L(d,{key:0,label:"Select Type:",prop:"code",class:"w-full"},{default:a(()=>[l(n,{modelValue:o(e).code,"onUpdate:modelValue":t[0]||(t[0]=i=>o(e).code=i)},{default:a(()=>[l(u,{label:"RETWEET_X"},{default:a(()=>[m("Retweet")]),_:1}),l(u,{label:"EVENT_PARTNER"},{default:a(()=>[m("Partner")]),_:1})]),_:1},8,["modelValue"])]),_:1})),l(d,{label:"Title:",prop:"title",class:"w-full"},{default:a(()=>[l(v,{style:{width:"100%"},"controls-position":"right",modelValue:o(e).title,"onUpdate:modelValue":t[1]||(t[1]=i=>o(e).title=i),placeholder:"Please enter",clearable:""},null,8,["modelValue"])]),_:1}),l(d,{label:"Description:",prop:"description",class:"w-full"},{default:a(()=>[l(v,{type:"textarea",style:{width:"100%"},"controls-position":"right",modelValue:o(e).description,"onUpdate:modelValue":t[2]||(t[2]=i=>o(e).description=i),placeholder:"Please enter",clearable:""},null,8,["modelValue"])]),_:1}),l(d,{label:"Mission Link:",class:"w-full"},{default:a(()=>[l(v,{style:{width:"100%"},"controls-position":"right",modelValue:o(e).url,"onUpdate:modelValue":t[3]||(t[3]=i=>o(e).url=i),placeholder:"Please enter",clearable:""},null,8,["modelValue"])]),_:1}),l(d,{label:"Order:",prop:"order",class:"w-full"},{default:a(()=>[l(x,{style:{width:"100%"},min:1,max:1e3,"controls-position":"right",modelValue:o(e).order,"onUpdate:modelValue":t[4]||(t[4]=i=>o(e).order=i),placeholder:"Please enter",clearable:""},null,8,["modelValue"])]),_:1}),l(d,{label:"Reward Type:",prop:"rewardType",class:"w-full"},{default:a(()=>[l(n,{modelValue:o(e).rewardType,"onUpdate:modelValue":t[5]||(t[5]=i=>o(e).rewardType=i)},{default:a(()=>[l(u,{label:1},{default:a(()=>[m("Points")]),_:1}),l(u,{label:2},{default:a(()=>[m("Soul Points")]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"Quantity:",prop:"rewardNum",class:"w-full"},{default:a(()=>[l(x,{style:{width:"100%"},min:1,max:o(e).rewardType===1?2e3:200,"controls-position":"right",modelValue:o(e).rewardNum,"onUpdate:modelValue":t[6]||(t[6]=i=>o(e).rewardNum=i),placeholder:"Please enter",clearable:""},null,8,["max","modelValue"])]),_:1}),l(d,{label:"Show as Latest:",prop:"mark",class:"w-full"},{default:a(()=>[l(n,{modelValue:o(e).mark,"onUpdate:modelValue":t[7]||(t[7]=i=>o(e).mark=i)},{default:a(()=>[l(u,{label:1},{default:a(()=>[m("Yes")]),_:1}),l(u,{label:0},{default:a(()=>[m("No")]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"Delete:",prop:"status",class:"w-full"},{default:a(()=>[l(n,{modelValue:o(e).status,"onUpdate:modelValue":t[8]||(t[8]=i=>o(e).status=i)},{default:a(()=>[l(u,{label:0},{default:a(()=>[m("Yes")]),_:1}),l(u,{label:1},{default:a(()=>[m("No")]),_:1})]),_:1},8,["modelValue"])]),_:1}),C("div",de,[l(E,{class:"w-[20%]",type:"info",onClick:t[9]||(t[9]=i=>y())},{default:a(()=>[m(" Cancel ")]),_:1}),l(E,{class:"w-[20%]",type:"success",loading:o(g),onClick:t[10]||(t[10]=i=>("throttle"in s?s.throttle:o(ne))(()=>{P(o(f))}))},{default:a(()=>[m(" Save ")]),_:1},8,["loading"])])]}),_:1},8,["model","rules"])]}),_:1},8,["model-value"])]),_:1})])}}});const pe=X(ue,[["__scopeId","data-v-9d8662a8"]]),me={class:"w-full h-[85vh] flex flex-col justify-between space-y-5 p-5"},ce={class:"flex items-center justify-end"},fe={class:"flex justify-end"},Me=M({__name:"mission",setup(U){const c=b(!1),r=b(!1),g=b(!1),e=b(),f=k({content:[]}),_=k({page:1,limit:20}),w=async()=>{try{r.value=!0;const s=await se();r.value=!1,s.code===200?(f.content=s.data,f.totalElements=s.total):(f.content=[],f.totalElements=0,V({message:s.msg,grouping:!0,type:"error"}))}catch{r.value=!1}},P=s=>{_.page=s,w()},y=s=>{_.limit=s,w()},N=async()=>{try{g.value=!0;const s=await re();g.value=!1,s.code===200?V({message:s.msg,grouping:!0,type:"success"}):V({message:s.msg,grouping:!0,type:"error"})}catch{}finally{g.value=!1}};return Y(()=>{w()}),(s,t)=>{const u=z,n=J,d=K,v=Z,x=ee,E=pe,R=te;return T(),F("div",me,[C("div",ce,[l(u,{class:"w-[100px]",type:"success",onClick:t[0]||(t[0]=p=>(c.value=!0,e.value={}))},{default:a(()=>[m(" Create Task ")]),_:1}),l(u,{class:"w-[100px]",type:"primary",onClick:t[1]||(t[1]=p=>N()),loading:o(g)},{default:a(()=>[m(" Publish Task ")]),_:1},8,["loading"])]),Q((T(),L(v,{ref:"multipleTableRef",class:"w-full flex-1",data:o(f).content,border:""},{default:a(()=>[l(n,{label:"Title",prop:"title",align:"center","show-overflow-tooltip":""}),l(n,{label:"Description",prop:"description",align:"center","show-overflow-tooltip":""}),l(n,{label:"Task Link",prop:"url",align:"center","show-overflow-tooltip":""}),l(n,{label:"Code",prop:"code",align:"center","show-overflow-tooltip":""}),l(n,{label:"Reward Points",prop:"points",align:"center"}),l(n,{label:"Reward Soul Points",prop:"soul",align:"center"}),l(n,{label:"Order",prop:"order",align:"center"}),l(n,{label:"Show as Latest",prop:"mark",align:"center"},{default:a(p=>[m(D(p.row.mark?"Yes":"No"),1)]),_:1}),l(n,{label:"Action",align:"center"},{default:a(p=>[l(d,{type:"success",onClick:$=>(e.value=p.row,c.value=!0)},{default:a(()=>[m("Edit")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[R,o(r)]]),C("div",fe,[l(x,{"current-page":o(_).page,"onUpdate:currentPage":t[2]||(t[2]=p=>o(_).page=p),"page-size":o(_).limit,"onUpdate:pageSize":t[3]||(t[3]=p=>o(_).limit=p),"page-sizes":[20,50,100,500,1e3],layout:"total, sizes, prev, pager, next, jumper",total:o(f).totalElements,onCurrentChange:P,onSizeChange:y},null,8,["current-page","page-size","total"])]),l(E,{modelValue:o(c),"onUpdate:modelValue":t[4]||(t[4]=p=>H(c)?c.value=p:null),"dialog-visible":o(c),"onUpdate:closeDialog":t[5]||(t[5]=p=>c.value=!1),item:o(e),"onUpdate:success":t[6]||(t[6]=p=>w())},null,8,["modelValue","dialog-visible","item"])])}}});export{Me as default};
