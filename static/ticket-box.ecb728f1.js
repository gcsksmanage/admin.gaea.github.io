import{d as L,r as i,e as h,g as N,o as m,c as E,j as n,i as o,u as e,k as _,w as f,h as x,D as S,t as U,E as I,x as J,s as $,y as j,z as q,l as z,m as A,v as G,p as M,a as O,b as P,_ as H}from"./entry.3e73d025.js";/* empty css                        *//* empty css                 */import{t as K}from"./throttle.fca0157a.js";/* empty css                  *//* empty css                 *//* empty css                     *//* empty css                   */import{v as Q}from"./adminManage.14b6e723.js";import{g as W}from"./index.3e9604f7.js";import"./request.32f2fe59.js";const X=p=>(M("data-v-095787c7"),p=p(),O(),p),Y={class:"text-[#EBEBEB] pt-10 px-5"},Z={class:"cursor-pointer hover:text-[#ebebeb]"},ee=X(()=>P("span",{class:"iconfont icon-copy"},null,-1)),te=L({__name:"ticket-box",setup(p){const T=i(!1),u=i(!1),w=i(),b=i(),y=h({content:[]}),B=i(),V=h({number:[{required:!0,message:"请输入票盒数量",trigger:"blur"}]}),d=h({number:null}),F=t=>{t&&t.resetFields()},R=async t=>{t&&(u.value||await t.validate(async(a,C)=>{if(a)try{u.value=!0;const r=await Q({number:d.number}),{cdkeys:l,activity:g}=r.data;b.value=g,r.code===200?(I.success({message:"创建成功",grouping:!0,type:"success"}),y.content=l.map(([s,v])=>({cdkey:s,numberOfTimes:v})),w.value=y.content.map(s=>s.cdkey).join(",")):I.error({message:r.msg,grouping:!0,type:"error"})}catch{}finally{u.value=!1,F(t)}}))};return(t,a)=>{const C=J,r=$,l=j,g=q,s=z,v=A,k=N("copy"),D=G;return m(),E("div",Y,[n(g,{ref_key:"ruleFormRef",ref:B,inline:!0,"label-position":"right","label-width":"90px",model:e(d),rules:e(V),class:"flex w-fit"},{default:o(()=>[n(r,{label:"票盒数:",prop:"number"},{default:o(()=>[n(C,{min:1,max:200,style:{width:"240px"},"controls-position":"right",modelValue:e(d).number,"onUpdate:modelValue":a[0]||(a[0]=c=>e(d).number=c),placeholder:"请输入需要创建的票盒数量",clearable:""},null,8,["modelValue"])]),_:1}),n(l,{class:"w-[20%]",type:"success",loading:e(u),onClick:a[1]||(a[1]=c=>("throttle"in t?t.throttle:e(K))(()=>{R(e(B))}))},{default:o(()=>[_(" 创建 ")]),_:1},8,["loading"]),f((m(),x(l,{type:"primary"},{default:o(()=>[_(" 复制所有票盒cdkey ")]),_:1})),[[k,e(w)]]),e(b)?f((m(),x(l,{key:0,type:"primary"},{default:o(()=>[_(" 复制活动代码 ")]),_:1})),[[k,`${("getJumpURL"in t?t.getJumpURL:e(W))()}/emotionalCheckIn/ticket?activity=${e(b)}`]]):S("",!0)]),_:1},8,["model","rules"]),f((m(),x(v,{ref:"multipleTableRef",height:"650px",data:e(y).content,border:""},{default:o(()=>[n(s,{prop:"cdkey",label:"cdkey",align:"center"},{default:o(c=>[f((m(),E("div",Z,[_(U(c.row.cdkey)+" ",1),ee])),[[k,c.row.cdkey]])]),_:1}),n(s,{prop:"numberOfTimes",label:"次数",align:"center"})]),_:1},8,["data"])),[[D,e(T)]])])}}});const de=H(te,[["__scopeId","data-v-095787c7"]]);export{de as default};
