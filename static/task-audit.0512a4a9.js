import{T as U,U as F,d as D,V,W as se,r as T,q,S as ie,X as O,Y as ce,Z as ue,$ as de,a0 as pe,a1 as fe,a2 as me,e as j,o as C,c as B,f as l,w as u,b as S,g as y,y as R,u as d,I as ge,J as _e,x as L,E as M,h as $,L as ve,K as he,j as be,m as we,l as H,n as ye,_ as xe,s as X,v as K,z as W,a3 as G,M as J,A as Q,B as Y,C as Z,D as z,F as ke,G as Ce,H as Te}from"./entry.f25ffcf8.js";import{_ as Re}from"./client-only.2cf1f8b0.js";/* empty css                  *//* empty css                 *//* empty css               *//* empty css                     *//* empty css                *//* empty css                  *//* empty css                   *//* empty css                       */import{y as ee,z as Ee,A as Le}from"./adminManage.4f456c6c.js";import{t as Se}from"./throttle.46d02480.js";/* empty css                 *//* empty css                   */import"./el-tooltip.4ed993c7.js";/* empty css                      *//* empty css                   */import{s as te}from"./index.ee23882a.js";/* empty css                */import"./request.0bd11efc.js";const N=globalThis.requestIdleCallback||(r=>{const o=Date.now(),_={didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-o))};return setTimeout(()=>{r(_)},1)}),Ae=globalThis.cancelIdleCallback||(r=>{clearTimeout(r)}),$e=r=>{const o=U();o.isHydrating?o.hooks.hookOnce("app:suspense:resolve",()=>{N(r)}):N(r)};async function ae(r,o=F()){const{path:_,matched:t}=o.resolve(r);if(!t.length||(o._routePreloaded||(o._routePreloaded=new Set),o._routePreloaded.has(_)))return;const s=o._preloadPromises=o._preloadPromises||[];if(s.length>4)return Promise.all(s).then(()=>ae(r,o));o._routePreloaded.add(_);const f=t.map(a=>{var v;return(v=a.components)==null?void 0:v.default}).filter(a=>typeof a=="function");for(const a of f){const v=Promise.resolve(a()).catch(()=>{}).finally(()=>s.splice(s.indexOf(v)));s.push(v)}await Promise.all(s)}const je=(...r)=>r.find(o=>o!==void 0),Pe="noopener noreferrer";/*! @__NO_SIDE_EFFECTS__ */function Be(r){const o=r.componentName||"NuxtLink",_=(t,s)=>{if(!t||r.trailingSlash!=="append"&&r.trailingSlash!=="remove")return t;const f=r.trailingSlash==="append"?pe:fe;if(typeof t=="string")return f(t,!0);const a="path"in t?t.path:s(t).path;return{...t,name:void 0,path:f(a,!0)}};return D({name:o,props:{to:{type:[String,Object],default:void 0,required:!1},href:{type:[String,Object],default:void 0,required:!1},target:{type:String,default:void 0,required:!1},rel:{type:String,default:void 0,required:!1},noRel:{type:Boolean,default:void 0,required:!1},prefetch:{type:Boolean,default:void 0,required:!1},noPrefetch:{type:Boolean,default:void 0,required:!1},activeClass:{type:String,default:void 0,required:!1},exactActiveClass:{type:String,default:void 0,required:!1},prefetchedClass:{type:String,default:void 0,required:!1},replace:{type:Boolean,default:void 0,required:!1},ariaCurrentValue:{type:String,default:void 0,required:!1},external:{type:Boolean,default:void 0,required:!1},custom:{type:Boolean,default:void 0,required:!1}},setup(t,{slots:s}){const f=F(),a=V(()=>{const c=t.to||t.href||"";return _(c,f.resolve)}),v=V(()=>t.external||t.target&&t.target!=="_self"?!0:typeof a.value=="object"?!1:a.value===""||se(a.value,{acceptRelative:!0})),x=T(!1),h=T(null),w=c=>{var i;h.value=t.custom?(i=c==null?void 0:c.$el)==null?void 0:i.nextElementSibling:c==null?void 0:c.$el};if(t.prefetch!==!1&&t.noPrefetch!==!0&&t.target!=="_blank"&&!ze()){const i=U();let e,n=null;q(()=>{const m=De();$e(()=>{e=N(()=>{var k;(k=h==null?void 0:h.value)!=null&&k.tagName&&(n=m.observe(h.value,async()=>{n==null||n(),n=null;const b=typeof a.value=="string"?a.value:f.resolve(a.value).fullPath;await Promise.all([i.hooks.callHook("link:prefetch",b).catch(()=>{}),!v.value&&ae(a.value,f).catch(()=>{})]),x.value=!0}))})})}),ie(()=>{e&&Ae(e),n==null||n(),n=null})}return()=>{var m,k;if(!v.value){const b={ref:w,to:a.value,activeClass:t.activeClass||r.activeClass,exactActiveClass:t.exactActiveClass||r.exactActiveClass,replace:t.replace,ariaCurrentValue:t.ariaCurrentValue,custom:t.custom};return t.custom||(x.value&&(b.class=t.prefetchedClass||r.prefetchedClass),b.rel=t.rel),O(ce("RouterLink"),b,s.default)}const c=typeof a.value=="object"?((m=f.resolve(a.value))==null?void 0:m.href)??null:a.value||null,i=t.target||null,e=t.noRel?null:je(t.rel,r.externalRelAttribute,c?Pe:"")||null,n=()=>me(c,{replace:t.replace});return t.custom?s.default?s.default({href:c,navigate:n,get route(){if(!c)return;const b=ue(c);return{path:b.pathname,fullPath:b.pathname,get query(){return de(b.search)},hash:b.hash,params:{},name:void 0,matched:[],redirectedFrom:void 0,meta:{},href:c}},rel:e,target:i,isExternal:v.value,isActive:!1,isExactActive:!1}):null:O("a",{ref:h,href:c,rel:e,target:i},(k=s.default)==null?void 0:k.call(s))}}})}const le=Be({componentName:"NuxtLink"});function De(){const r=U();if(r._observer)return r._observer;let o=null;const _=new Map,t=(f,a)=>(o||(o=new IntersectionObserver(v=>{for(const x of v){const h=_.get(x.target);(x.isIntersecting||x.intersectionRatio>0)&&h&&h()}})),_.set(f,a),o.observe(f),()=>{_.delete(f),o.unobserve(f),_.size===0&&(o.disconnect(),o=null)});return r._observer={observe:t}}function ze(){const r=navigator.connection;return!!(r&&(r.saveData||/2g/.test(r.effectiveType)))}const Ie={class:"text-[#ebebeb] text-[16px] mb-5"},Ne={class:"text-red-500"},Ue={class:"w-full flex justify-end mt-5"},qe=D({__name:"Reject",props:{dialogVisible:{type:Boolean,default:!1},item:{default:""}},emits:["update:closeDialog","update:success"],setup(r,{emit:o}){const _=r,t=T(),s=T(!1),f=T([{value:"Repetitive or overly similar content"},{value:"Low view count"},{value:"Contains prohibited content (e.g., ads, sensitive information, etc.)"},{value:"Fails to reflect GAEA-related topics or value"},{value:"Invalid or missing images/links"},{value:"The uploaded Discord account does not match the one that is linked."},{value:"Empty text or uploaded file is blank"},{value:"Incomplete task submission"},{value:"Use of auto-generated or non-original content"},{value:"Unclear or vague language expression"}]),a=j({reason:""}),v=i=>/^[^\u4e00-\u9fa5]*$/.test(i)&&i.length<=128,x=j({reason:[{required:!0,message:"驳回原因为必填项",trigger:"change"},{validator:(i,e,n)=>{e&&!v(e)?n(new Error("仅限英文内容，且长度不得超过128字符")):n()},trigger:"blur"}]}),h=()=>{o("update:closeDialog"),a.reason=""},w=i=>{a.reason=i.target.value},c=async i=>{i&&await i.validate(async(e,n)=>{e&&M.confirm(`驳回用户名为：${_.item.username} 的申请`,"Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{try{s.value=!0;const m=await ee({id:_.item.id,status:-2,reason:a.reason});m.code===200?($.success(m.data),o("update:success"),h()):$.error(m.msg)}catch{}finally{s.value=!1}}).catch(()=>{$({type:"info",message:"canceled"})})})};return(i,e)=>{const n=ve,m=he,k=be,b=we,A=H,E=ye,P=Re;return C(),B("div",null,[l(P,null,{default:u(()=>[l(E,{draggable:"","model-value":i.$props.dialogVisible,style:{"background-color":"black",border:"1px  #ebebeb solid","border-radius":"10px","padding-bottom":"30px"},title:"",width:"550px",class:"px-10","align-center":"",onClose:h},{default:u(()=>[S("p",Ie,[y("驳回用户名为："),S("span",Ne,R(_.item.username),1),y(" 的申请")]),l(b,{ref_key:"ruleFormRef",ref:t,class:"w-full p-5",inline:!0,"label-position":"right","label-width":"70px",model:d(a),rules:d(x)},{default:u(()=>[l(k,{label:"数量:",prop:"reason",class:"w-full"},{default:u(()=>[l(m,{modelValue:d(a).reason,"onUpdate:modelValue":e[0]||(e[0]=p=>d(a).reason=p),clearable:"",filterable:"","allow-create":"","default-first-option":"",onInput:e[1]||(e[1]=p=>w(p)),"reserve-keyword":!1,placeholder:"请选择驳回原因",style:{height:"32px","border-radius":"50px",width:"250px"}},{default:u(()=>[(C(!0),B(ge,null,_e(d(f),(p,I)=>(C(),L(n,{key:p.value,label:`${I+1}.${p.value}`,value:p.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),S("div",Ue,[l(A,{class:"w-[20%]",type:"info",onClick:e[2]||(e[2]=p=>h())},{default:u(()=>[y(" 取消 ")]),_:1}),l(A,{loading:d(s),class:"w-[20%]",type:"danger",onClick:e[3]||(e[3]=p=>("throttle"in i?i.throttle:d(Se))(()=>{c(d(t))}))},{default:u(()=>[y(" 驳回 ")]),_:1},8,["loading"])])]),_:1},8,["model-value"])]),_:1})])}}});const ne=xe(qe,[["__scopeId","data-v-3c684eee"]]),Ve={class:"w-full h-full flex flex-col space-y-2 p-6"},Oe={class:"w-full flex-1 overflow-y-auto"},Fe={class:"flex justify-end"},Me=D({__name:"Index",props:{level:{default:""}},setup(r){const o=r,_=T(),t=T(!1),s=T(!1),f=j({content:[],totalElements:0}),a=j({level:Number(o.level),page:1,limit:20}),v=e=>{a.page=e,w()},x=e=>{a.limit=e,w()},h=e=>{const k=new URL(e).pathname.split("_");return k[k.length-1]},w=async()=>{try{s.value=!0;const e={...a},n=await Ee(e);s.value=!1,n.code&&(f.content=n.data.map(m=>({...m,passThroughLoading:!1,rejectLoading:!1})))}catch{s.value=!1}finally{s.value=!1}},c=e=>{M.confirm(`通过用户名为：${e.username} 的申请`,"Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{try{e.passThroughLoading=!0;const n=await ee({id:e.id,status:2,reason:""});e.passThroughLoading=!1,n.code===200?($.success(n.data),w()):$.error(n.msg)}catch{}finally{e.passThroughLoading=!1}}).catch(()=>{$({type:"info",message:"canceled"})})},i=e=>{_.value=e,t.value=!0};return q(async()=>{await X(),w()}),(e,n)=>{const m=W,k=G,b=le,A=J,E=H,P=Q,p=Y,I=ne,oe=Z;return C(),B("div",Ve,[S("div",Oe,[K((C(),L(P,{ref:"multipleTableRef",height:"550px",data:d(f).content,border:"",style:{height:"100%"},"header-cell-style":{background:"#e0eeee"}},{default:u(()=>[l(m,{prop:"userid",label:"用户ID",align:"center",width:"140px",sortable:""}),l(m,{prop:"username",label:"用户名",align:"center",width:"150px","show-overflow-tooltip":"",sortable:""}),l(m,{prop:"created_time",label:"上传时间",align:"center",width:"150px",sortable:"","show-overflow-tooltip":""}),l(m,{prop:"type",label:"勋章",align:"center",sortable:""},{default:u(g=>[l(k,{type:g.row.type===1?"success":g.row.type===2?"warning":"danger",size:"small",effect:"dark"},{default:u(()=>[y(R(g.row.type===1?"一级":g.row.type===2?"二级":"三级"),1)]),_:2},1032,["type"])]),_:1}),l(m,{prop:"medal_id",label:"任务id",align:"center","min-width":"100px",sortable:""}),l(m,{prop:"code",label:"任务代号",align:"center","min-width":"120px",sortable:""}),l(m,{prop:"social_x_name",label:"社交X名称",align:"center","min-width":"130px","show-overflow-tooltip":""},{default:u(g=>[y(R(g.row.social_x_name||"未绑定"),1)]),_:1}),l(m,{prop:"social_dc_name",label:"Discord名称",align:"center","min-width":"140px","show-overflow-tooltip":""},{default:u(g=>[y(R(g.row.social_dc_name||"未绑定"),1)]),_:1}),l(m,{prop:"url",label:"文件",align:"center",width:"150","show-overflow-tooltip":""},{default:u(g=>[l(A,{class:"box-item",title:"",content:`${h(g.row.url)}`,placement:"top-start"},{reference:u(()=>[l(b,{to:g.row.url,target:"_blank",rel:"noopener",class:"hover:underline underline-offset-4 u-line-1"},{default:u(()=>[y(R(("stringStar"in e?e.stringStar:d(te))({value:h(g.row.url),characters:"***",start:4,end:7})),1)]),_:2},1032,["to"])]),_:2},1032,["content"])]),_:1}),l(m,{label:"操作",width:"320",fixed:"right",align:"center"},{default:u(g=>[l(b,{to:g.row.url,target:"_blank",rel:"noopener",class:"mr-3"},{default:u(()=>[l(E,{type:"primary"},{default:u(()=>[y("查看")]),_:1})]),_:2},1032,["to"]),l(E,{type:"success",loading:g.row.passThroughLoading,onClick:re=>c(g.row)},{default:u(()=>[y("通过")]),_:2},1032,["loading","onClick"]),l(E,{type:"danger",loading:g.row.rejectLoading,onClick:re=>i(g.row)},{default:u(()=>[y("驳回")]),_:2},1032,["loading","onClick"])]),_:1})]),_:1},8,["data"])),[[oe,d(s)]]),S("div",Fe,[l(p,{"current-page":d(a).page,"onUpdate:currentPage":n[0]||(n[0]=g=>d(a).page=g),"page-size":d(a).limit,"onUpdate:pageSize":n[1]||(n[1]=g=>d(a).limit=g),"page-sizes":[20,50,100,500,1e3],layout:"total, sizes, prev, pager, next, jumper",total:d(f).totalElements,onCurrentChange:v,onSizeChange:x},null,8,["current-page","page-size","total"])])]),l(I,{"dialog-visible":d(t),"onUpdate:closeDialog":n[2]||(n[2]=g=>t.value=!1),item:d(_),"onUpdate:success":n[3]||(n[3]=g=>w())},null,8,["dialog-visible","item"])])}}}),He={class:"w-full h-full flex flex-col space-y-2 p-6"},Xe={class:"w-full flex-1 overflow-y-auto"},Ke={class:"flex justify-end"},We=D({__name:"Records",props:{level:{default:""}},setup(r){const o=r,_=T(),t=T(!1),s=T(!1),f=j({content:[],totalElements:0}),a=j({level:Number(o.level),page:1,limit:20}),v=c=>{a.page=c,w()},x=c=>{a.limit=c,w()},h=c=>{const n=new URL(c).pathname.split("_");return n[n.length-1]},w=async()=>{try{s.value=!0;const c={...a},i=await Le(c);s.value=!1,i.code&&(f.content=i.data.map(e=>({...e,passThroughLoading:!1,rejectLoading:!1})))}catch{s.value=!1}finally{s.value=!1}};return q(async()=>{await X(),w()}),(c,i)=>{const e=W,n=G,m=le,k=J,b=Q,A=Y,E=ne,P=Z;return C(),B("div",He,[S("div",Xe,[K((C(),L(b,{ref:"multipleTableRef",height:"550px",data:d(f).content,border:"",style:{height:"100%"},"header-cell-style":{background:"#e0eeee"}},{default:u(()=>[l(e,{prop:"userid",label:"用户ID",align:"center",width:"140px",sortable:""}),l(e,{prop:"username",label:"用户名",align:"center",width:"150px","show-overflow-tooltip":"",sortable:""}),l(e,{prop:"created_time",label:"上传时间",align:"center",width:"150px",sortable:"","show-overflow-tooltip":""}),l(e,{prop:"type",label:"勋章",align:"center",sortable:""},{default:u(p=>[l(n,{type:p.row.type===1?"success":p.row.type===2?"warning":"danger",size:"small",effect:"dark"},{default:u(()=>[y(R(p.row.type===1?"一级":p.row.type===2?"二级":"三级"),1)]),_:2},1032,["type"])]),_:1}),l(e,{prop:"medal_id",label:"任务id",align:"center","min-width":"100px",sortable:""}),l(e,{prop:"code",label:"任务代号",align:"center","min-width":"120px",sortable:""}),l(e,{prop:"social_x_name",label:"社交X名称",align:"center","min-width":"130px","show-overflow-tooltip":""},{default:u(p=>[y(R(p.row.social_x_name||"未绑定"),1)]),_:1}),l(e,{prop:"social_dc_name",label:"Discord名称",align:"center","min-width":"140px","show-overflow-tooltip":""},{default:u(p=>[y(R(p.row.social_dc_name||"未绑定"),1)]),_:1}),l(e,{prop:"url",label:"文件",align:"center",width:"150","show-overflow-tooltip":""},{default:u(p=>[l(k,{class:"box-item",title:"",content:`${h(p.row.url)}`,placement:"top-start"},{reference:u(()=>[l(m,{to:p.row.url,target:"_blank",rel:"noopener",class:"hover:underline underline-offset-4 u-line-1"},{default:u(()=>[y(R(("stringStar"in c?c.stringStar:d(te))({value:h(p.row.url),characters:"***",start:4,end:7})),1)]),_:2},1032,["to"])]),_:2},1032,["content"])]),_:1}),l(e,{prop:"note",label:"拒绝原因",align:"center","min-width":"100px","show-overflow-tooltip":""})]),_:1},8,["data"])),[[P,d(s)]]),S("div",Ke,[l(A,{"current-page":d(a).page,"onUpdate:currentPage":i[0]||(i[0]=p=>d(a).page=p),"page-size":d(a).limit,"onUpdate:pageSize":i[1]||(i[1]=p=>d(a).limit=p),"page-sizes":[20,50,100,500,1e3],layout:"total, sizes, prev, pager, next, jumper",total:d(f).totalElements,onCurrentChange:v,onSizeChange:x},null,8,["current-page","page-size","total"])])]),l(E,{"dialog-visible":d(t),"onUpdate:closeDialog":i[2]||(i[2]=p=>t.value=!1),item:d(_),"onUpdate:success":i[3]||(i[3]=p=>w())},null,8,["dialog-visible","item"])])}}}),Ge={class:"w-full h-full flex flex-col space-y-2 p-6"},_t=D({__name:"task-audit",setup(r){const o=T("2");return(_,t)=>{const s=Me,f=Ce,a=We,v=Te;return C(),B("div",Ge,[l(v,{modelValue:d(o),"onUpdate:modelValue":t[0]||(t[0]=x=>ke(o)?o.value=x:null),class:"w-full h-full bg-black"},{default:u(()=>[l(f,{label:"待审核 - 等级 2",name:"2"},{default:u(()=>[d(o)==="2"?(C(),L(s,{key:0,level:2})):z("",!0)]),_:1}),l(f,{label:"待审核 - 等级 3",name:"3"},{default:u(()=>[d(o)==="3"?(C(),L(s,{key:0,level:3})):z("",!0)]),_:1}),l(f,{label:"已审核 - 等级 2",name:"4"},{default:u(()=>[d(o)==="4"?(C(),L(a,{key:0,level:2})):z("",!0)]),_:1}),l(f,{label:"已审核 - 等级 3",name:"5"},{default:u(()=>[d(o)==="5"?(C(),L(a,{key:0,level:3})):z("",!0)]),_:1})]),_:1},8,["modelValue"])])}}});export{_t as default};
