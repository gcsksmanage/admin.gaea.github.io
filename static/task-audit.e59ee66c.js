import{T as V,U as z,d as B,V as D,W as Z,r as C,q as F,S as J,X as I,Y as Q,Z as Y,$ as ee,a0 as te,a1 as ae,a2 as le,e as A,o as T,c as P,f as s,w as d,b as L,g as x,y as S,u as f,I as ne,J as oe,x as $,E as O,h as E,L as re,K as se,j as ie,m as ce,l as M,n as ue,_ as de,s as fe,v as pe,z as me,a3 as ge,M as ve,A as _e,B as he,C as be,D as U,F as ye,G as xe,H as we}from"./entry.9383e5b4.js";import{_ as ke}from"./client-only.de93b4ab.js";/* empty css                  *//* empty css                 *//* empty css               *//* empty css                     *//* empty css                *//* empty css                  *//* empty css                   *//* empty css                       */import{v as H,x as Ce}from"./adminManage.03b1ec92.js";import{t as Te}from"./throttle.46d02480.js";/* empty css                 *//* empty css                   */import"./el-tooltip.4ed993c7.js";/* empty css                      *//* empty css                   */import{s as Ee}from"./index.ee23882a.js";/* empty css                */import"./request.e6f65565.js";const N=globalThis.requestIdleCallback||(l=>{const t=Date.now(),g={didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-t))};return setTimeout(()=>{l(g)},1)}),Re=globalThis.cancelIdleCallback||(l=>{clearTimeout(l)}),Se=l=>{const t=V();t.isHydrating?t.hooks.hookOnce("app:suspense:resolve",()=>{N(l)}):N(l)};async function K(l,t=z()){const{path:g,matched:e}=t.resolve(l);if(!e.length||(t._routePreloaded||(t._routePreloaded=new Set),t._routePreloaded.has(g)))return;const i=t._preloadPromises=t._preloadPromises||[];if(i.length>4)return Promise.all(i).then(()=>K(l,t));t._routePreloaded.add(g);const c=e.map(n=>{var v;return(v=n.components)==null?void 0:v.default}).filter(n=>typeof n=="function");for(const n of c){const v=Promise.resolve(n()).catch(()=>{}).finally(()=>i.splice(i.indexOf(v)));i.push(v)}await Promise.all(i)}const Le=(...l)=>l.find(t=>t!==void 0),Ae="noopener noreferrer";/*! @__NO_SIDE_EFFECTS__ */function Pe(l){const t=l.componentName||"NuxtLink",g=(e,i)=>{if(!e||l.trailingSlash!=="append"&&l.trailingSlash!=="remove")return e;const c=l.trailingSlash==="append"?te:ae;if(typeof e=="string")return c(e,!0);const n="path"in e?e.path:i(e).path;return{...e,name:void 0,path:c(n,!0)}};return B({name:t,props:{to:{type:[String,Object],default:void 0,required:!1},href:{type:[String,Object],default:void 0,required:!1},target:{type:String,default:void 0,required:!1},rel:{type:String,default:void 0,required:!1},noRel:{type:Boolean,default:void 0,required:!1},prefetch:{type:Boolean,default:void 0,required:!1},noPrefetch:{type:Boolean,default:void 0,required:!1},activeClass:{type:String,default:void 0,required:!1},exactActiveClass:{type:String,default:void 0,required:!1},prefetchedClass:{type:String,default:void 0,required:!1},replace:{type:Boolean,default:void 0,required:!1},ariaCurrentValue:{type:String,default:void 0,required:!1},external:{type:Boolean,default:void 0,required:!1},custom:{type:Boolean,default:void 0,required:!1}},setup(e,{slots:i}){const c=z(),n=D(()=>{const r=e.to||e.href||"";return g(r,c.resolve)}),v=D(()=>e.external||e.target&&e.target!=="_self"?!0:typeof n.value=="object"?!1:n.value===""||Z(n.value,{acceptRelative:!0})),b=C(!1),_=C(null),w=r=>{var p;_.value=e.custom?(p=r==null?void 0:r.$el)==null?void 0:p.nextElementSibling:r==null?void 0:r.$el};if(e.prefetch!==!1&&e.noPrefetch!==!0&&e.target!=="_blank"&&!je()){const p=V();let o,a=null;F(()=>{const m=Be();Se(()=>{o=N(()=>{var y;(y=_==null?void 0:_.value)!=null&&y.tagName&&(a=m.observe(_.value,async()=>{a==null||a(),a=null;const h=typeof n.value=="string"?n.value:c.resolve(n.value).fullPath;await Promise.all([p.hooks.callHook("link:prefetch",h).catch(()=>{}),!v.value&&K(n.value,c).catch(()=>{})]),b.value=!0}))})})}),J(()=>{o&&Re(o),a==null||a(),a=null})}return()=>{var m,y;if(!v.value){const h={ref:w,to:n.value,activeClass:e.activeClass||l.activeClass,exactActiveClass:e.exactActiveClass||l.exactActiveClass,replace:e.replace,ariaCurrentValue:e.ariaCurrentValue,custom:e.custom};return e.custom||(b.value&&(h.class=e.prefetchedClass||l.prefetchedClass),h.rel=e.rel),I(Q("RouterLink"),h,i.default)}const r=typeof n.value=="object"?((m=c.resolve(n.value))==null?void 0:m.href)??null:n.value||null,p=e.target||null,o=e.noRel?null:Le(e.rel,l.externalRelAttribute,r?Ae:"")||null,a=()=>le(r,{replace:e.replace});return e.custom?i.default?i.default({href:r,navigate:a,get route(){if(!r)return;const h=Y(r);return{path:h.pathname,fullPath:h.pathname,get query(){return ee(h.search)},hash:h.hash,params:{},name:void 0,matched:[],redirectedFrom:void 0,meta:{},href:r}},rel:o,target:p,isExternal:v.value,isActive:!1,isExactActive:!1}):null:I("a",{ref:_,href:r,rel:o,target:p},(y=i.default)==null?void 0:y.call(i))}}})}const $e=Pe({componentName:"NuxtLink"});function Be(){const l=V();if(l._observer)return l._observer;let t=null;const g=new Map,e=(c,n)=>(t||(t=new IntersectionObserver(v=>{for(const b of v){const _=g.get(b.target);(b.isIntersecting||b.intersectionRatio>0)&&_&&_()}})),g.set(c,n),t.observe(c),()=>{g.delete(c),t.unobserve(c),g.size===0&&(t.disconnect(),t=null)});return l._observer={observe:e}}function je(){const l=navigator.connection;return!!(l&&(l.saveData||/2g/.test(l.effectiveType)))}const qe={class:"text-[#ebebeb] text-[16px] mb-5"},Ne={class:"text-red-500"},Ve={class:"w-full flex justify-end mt-5"},De=B({__name:"Reject",props:{dialogVisible:{type:Boolean,default:!1},item:{default:""}},emits:["update:closeDialog","update:success"],setup(l,{emit:t}){const g=l,e=C(),i=C([{value:"Repetitive or overly similar content"},{value:"Low view count"},{value:"Contains prohibited content (e.g., ads, sensitive information, etc.)"},{value:"Fails to reflect GAEA-related topics or value"},{value:"Invalid or missing images/links"},{value:"Empty text or uploaded file is blank"},{value:"Incomplete task submission"},{value:"Use of auto-generated or non-original content"},{value:"Unclear or vague language expression"}]),c=A({reason:""}),n=r=>/^[A-Za-z\s.,'"()!@#$%^&*_-]+$/.test(r)&&r.length<=128,v=A({reason:[{required:!0,message:"驳回原因为必填项",trigger:"change"},{validator:(r,p,o)=>{p&&!n(p)?o(new Error("仅限英文内容，且长度不得超过128字符")):o()},trigger:"blur"}]}),b=C(!1),_=()=>{t("update:closeDialog")},w=async r=>{r&&await r.validate(async(p,o)=>{p&&O.confirm(`驳回用户名为：${g.item.username} 的申请`,"Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{try{b.value=!0;const a=await H({id:g.item.id,status:-2,reason:c.reason});b.value=!1,a.code===200?(E.success(a.data),t("update:success"),_()):E.error(a.msg)}catch{}finally{b.value=!1}}).catch(()=>{E({type:"info",message:"canceled"})})})};return(r,p)=>{const o=re,a=se,m=ie,y=ce,h=M,j=ue,R=ke;return T(),P("div",null,[s(R,null,{default:d(()=>[s(j,{draggable:"","model-value":r.$props.dialogVisible,style:{"background-color":"black",border:"1px  #ebebeb solid","border-radius":"10px","padding-bottom":"30px"},title:"",width:"550px",class:"px-10","align-center":"",onClose:_},{default:d(()=>[L("p",qe,[x("驳回用户名为："),L("span",Ne,S(g.item.username),1),x(" 的申请")]),s(y,{ref_key:"ruleFormRef",ref:e,class:"w-full p-5",inline:!0,"label-position":"right","label-width":"70px",model:f(c),rules:f(v)},{default:d(()=>[s(m,{label:"数量:",prop:"reason",class:"w-full"},{default:d(()=>[s(a,{modelValue:f(c).reason,"onUpdate:modelValue":p[0]||(p[0]=k=>f(c).reason=k),clearable:"",filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1,placeholder:"请选择驳回原因",style:{height:"32px","border-radius":"50px",width:"250px"}},{default:d(()=>[(T(!0),P(ne,null,oe(f(i),(k,q)=>(T(),$(o,{key:k.value,label:`${q+1}.${k.value}`,value:k.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),L("div",Ve,[s(h,{class:"w-[20%]",type:"info",onClick:p[1]||(p[1]=k=>_())},{default:d(()=>[x(" 取消 ")]),_:1}),s(h,{loading:f(b),class:"w-[20%]",type:"success",onClick:p[2]||(p[2]=k=>("throttle"in r?r.throttle:f(Te))(()=>{w(f(e))}))},{default:d(()=>[x(" 保存 ")]),_:1},8,["loading"])])]),_:1},8,["model-value"])]),_:1})])}}});const Ie=de(De,[["__scopeId","data-v-58a9f061"]]),Ue={class:"w-full h-full flex flex-col space-y-2 p-6"},ze={class:"w-full flex-1 overflow-y-auto"},Fe={class:"flex justify-end"},Oe=B({__name:"Index",props:{level:{default:""}},setup(l){const t=l,g=C(),e=C(!1),i=C(!1),c=A({content:[],totalElements:0}),n=A({level:Number(t.level),page:1,limit:20}),v=o=>{n.page=o,w()},b=o=>{n.limit=o,w()},_=o=>{const y=new URL(o).pathname.split("_");return y[y.length-1]},w=async()=>{try{i.value=!0;const o={...n},a=await Ce(o);i.value=!1,a.code&&(c.content=a.data.map(m=>({...m,passThroughLoading:!1,rejectLoading:!1})))}catch{i.value=!1}finally{i.value=!1}},r=o=>{O.confirm(`通过用户名为：${o.username} 的申请`,"Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{try{o.passThroughLoading=!0;const a=await H({id:o.id,status:2,reason:""});o.passThroughLoading=!1,a.code===200?(E.success(a.data),w()):E.error(a.msg)}catch{}finally{o.passThroughLoading=!1}}).catch(()=>{E({type:"info",message:"canceled"})})},p=o=>{g.value=o,e.value=!0};return F(async()=>{await fe(),w()}),(o,a)=>{const m=me,y=ge,h=$e,j=ve,R=M,k=_e,q=he,W=Ie,X=be;return T(),P("div",Ue,[L("div",ze,[pe((T(),$(k,{ref:"multipleTableRef",height:"600px",data:f(c).content,border:"",style:{height:"100%"},"header-cell-style":{background:"#e0eeee"}},{default:d(()=>[s(m,{prop:"userid",label:"用户ID",align:"center",width:"140px",sortable:""}),s(m,{prop:"username",label:"用户名",align:"center",width:"150px","show-overflow-tooltip":"",sortable:""}),s(m,{prop:"created_time",label:"上传时间",align:"center",width:"150px",sortable:"","show-overflow-tooltip":""}),s(m,{prop:"type",label:"勋章",align:"center",sortable:""},{default:d(u=>[s(y,{type:u.row.type===1?"success":u.row.type===2?"warning":"danger",size:"small",effect:"dark"},{default:d(()=>[x(S(u.row.type===1?"一级":u.row.type===2?"二级":"三级"),1)]),_:2},1032,["type"])]),_:1}),s(m,{prop:"medal_id",label:"任务id",align:"center","min-width":"100px",sortable:""}),s(m,{prop:"code",label:"任务代号",align:"center","min-width":"120px",sortable:""}),s(m,{prop:"social_x_name",label:"社交X名称",align:"center","min-width":"130px","show-overflow-tooltip":""},{default:d(u=>[x(S(u.row.social_x_name||"未绑定"),1)]),_:1}),s(m,{prop:"social_dc_name",label:"Discord名称",align:"center","min-width":"140px","show-overflow-tooltip":""},{default:d(u=>[x(S(u.row.social_dc_name||"未绑定"),1)]),_:1}),s(m,{prop:"url",label:"文件",align:"center",width:"150","show-overflow-tooltip":""},{default:d(u=>[s(j,{class:"box-item",title:"",content:`${_(u.row.url)}`,placement:"top-start"},{reference:d(()=>[s(h,{to:u.row.url,target:"_blank",rel:"noopener",class:"hover:underline underline-offset-4 u-line-1"},{default:d(()=>[x(S(("stringStar"in o?o.stringStar:f(Ee))({value:_(u.row.url),characters:"***",start:4,end:7})),1)]),_:2},1032,["to"])]),_:2},1032,["content"])]),_:1}),s(m,{label:"操作",width:"320",fixed:"right",align:"center"},{default:d(u=>[s(h,{to:u.row.url,target:"_blank",rel:"noopener",class:"mr-3"},{default:d(()=>[s(R,{type:"primary"},{default:d(()=>[x("查看")]),_:1})]),_:2},1032,["to"]),s(R,{type:"success",loading:u.row.passThroughLoading,onClick:G=>r(u.row)},{default:d(()=>[x("通过")]),_:2},1032,["loading","onClick"]),s(R,{type:"danger",loading:u.row.rejectLoading,onClick:G=>p(u.row)},{default:d(()=>[x("驳回")]),_:2},1032,["loading","onClick"])]),_:1})]),_:1},8,["data"])),[[X,f(i)]]),L("div",Fe,[s(q,{"current-page":f(n).page,"onUpdate:currentPage":a[0]||(a[0]=u=>f(n).page=u),"page-size":f(n).limit,"onUpdate:pageSize":a[1]||(a[1]=u=>f(n).limit=u),"page-sizes":[20,50,100,500,1e3],layout:"total, sizes, prev, pager, next, jumper",total:f(c).totalElements,onCurrentChange:v,onSizeChange:b},null,8,["current-page","page-size","total"])])]),s(W,{"dialog-visible":f(e),"onUpdate:closeDialog":a[2]||(a[2]=u=>e.value=!1),item:f(g),"onUpdate:success":a[3]||(a[3]=u=>w())},null,8,["dialog-visible","item"])])}}}),Me={class:"w-full h-full flex flex-col space-y-2 p-6"},dt=B({__name:"task-audit",setup(l){const t=C("2");return(g,e)=>{const i=Oe,c=xe,n=we;return T(),P("div",Me,[s(n,{modelValue:f(t),"onUpdate:modelValue":e[0]||(e[0]=v=>ye(t)?t.value=v:null),class:"w-full h-full bg-black"},{default:d(()=>[s(c,{label:"等级2",name:"2"},{default:d(()=>[f(t)=="2"?(T(),$(i,{key:0,level:f(t)},null,8,["level"])):U("",!0)]),_:1}),s(c,{label:"等级3",name:"3"},{default:d(()=>[f(t)=="3"?(T(),$(i,{key:0,level:f(t)},null,8,["level"])):U("",!0)]),_:1})]),_:1},8,["modelValue"])])}}});export{dt as default};
