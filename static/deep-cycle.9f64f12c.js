import{d as A,r as x,e as k,o as y,c as S,f as o,w as r,b as B,y as f,u as t,x as h,D as V,g as b,h as T,k as M,j as N,l as z,m as O,n as P,_ as j,q as R,v as G,z as H,M as X,A as Y,B as J,C as K,F as Q,G as W,H as Z}from"./entry.14aaf0a0.js";import{_ as ee}from"./client-only.0c3df5ef.js";/* empty css                        *//* empty css                 *//* empty css                *//* empty css                  *//* empty css                   */import{h as te,i as oe,j as le}from"./adminManage.cc428882.js";import{t as ae}from"./throttle.46d02480.js";/* empty css                 *//* empty css               *//* empty css                */import"./el-tooltip.4ed993c7.js";/* empty css                     *//* empty css                      *//* empty css                  *//* empty css                   */import{b as q}from"./index.0b53fe87.js";/* empty css                */import"./request.037fe931.js";const ne={class:"text-[#ebebeb] text-[16px]"},re={class:"w-full flex justify-end"},se=A({__name:"Add",props:{dialogVisible:{type:Boolean,default:!1},item:{default:null}},emits:["update:closeDialog","update:success"],setup($,{emit:p}){const d=$,g=x(!1),c=x(),_=k({number:[{required:!0,message:"请输入",trigger:"blur"}],duration:[{required:!0,message:"请输入",trigger:"blur"}],price:[{required:!0,message:"请输入",trigger:"blur"}],proportion:[{required:!0,message:"请输入",trigger:"blur"}],putbox:[{required:!0,message:"请输入",trigger:"blur"}],putsoul:[{required:!0,message:"请输入",trigger:"blur"}],putmoney:[{required:!0,message:"请输入",trigger:"blur"}]}),e=k({id:null,number:1,putmoney:300,putbox:1500,putsoul:6e3,price:.4,duration:24,proportion:50}),w=m=>{m&&m.resetFields()},U=async m=>{m&&(g.value||await m.validate(async(n,a)=>{var v;if(n)try{g.value=!0;const i={id:(v=d.item)==null?void 0:v.period_id,number:e.number,putmoney:e.putmoney*1e6,putbox:e.putbox,putsoul:e.putsoul,price:e.price*1e6,duration:e.duration*3600,proportion:e.proportion};var l=null;i.id?(delete i.number,l=await te(i)):(delete i.id,l=await oe(i)),l.code===200?(T.success({message:"创建成功",grouping:!0,type:"success"}),p("update:success"),C()):T.error({message:l.msg,grouping:!0,type:"error"})}catch{}finally{g.value=!1,w(m)}}))},C=()=>{p("update:closeDialog"),w(c.value)},D=async()=>{var m;(m=d.item)!=null&&m.period_id&&(e.id=d.item.period_id,e.putmoney=d.item.putmoney/1e6,e.putbox=d.item.putbox,e.putsoul=d.item.putsoul,e.price=d.item.price/1e6,e.duration=d.item.duration/3600,e.proportion=d.item.proportion)};return(m,n)=>{const a=M,l=N,v=z,i=O,E=P,F=ee;return y(),S("div",null,[o(F,null,{default:r(()=>[o(E,{draggable:"","model-value":m.$props.dialogVisible,style:{"background-color":"black",border:"1px  #ebebeb solid","border-radius":"10px","padding-bottom":"30px"},title:"",width:"500px",class:"px-10","align-center":"",onClose:C,onOpen:n[9]||(n[9]=u=>D())},{default:r(()=>[B("p",ne,f(t(e).id?`编辑 纪元 ${d.item.epoch_id} 时代 ${d.item.phase_id}`:"新增抉择周期"),1),o(i,{ref_key:"ruleFormRef",ref:c,class:"w-full p-5",inline:!0,"label-position":"right","label-width":"140px",model:t(e),rules:t(_)},{default:r(()=>[t(e).id?V("",!0):(y(),h(l,{key:0,label:"数量:",prop:"number",class:"w-full"},{default:r(()=>[o(a,{style:{width:"100%"},min:1,max:200,"controls-position":"right",modelValue:t(e).number,"onUpdate:modelValue":n[0]||(n[0]=u=>t(e).number=u),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1})),o(l,{label:"时长(小时):",prop:"duration",class:"w-full"},{default:r(()=>[o(a,{style:{width:"100%"},min:0,max:100,"controls-position":"right",modelValue:t(e).duration,"onUpdate:modelValue":n[1]||(n[1]=u=>t(e).duration=u),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),o(l,{label:"底价(USD):",prop:"price",class:"w-full"},{default:r(()=>[o(a,{style:{width:"100%"},min:0,max:1,"controls-position":"right",modelValue:t(e).price,"onUpdate:modelValue":n[2]||(n[2]=u=>t(e).price=u),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),o(l,{label:"底仓:(USD)",prop:"putmoney",class:"w-full"},{default:r(()=>[o(a,{style:{width:"100%"},min:0,max:1e3,"controls-position":"right",modelValue:t(e).putmoney,"onUpdate:modelValue":n[3]||(n[3]=u=>t(e).putmoney=u),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),o(l,{label:"底仓:(BOX)",prop:"putbox",class:"w-full"},{default:r(()=>[o(a,{style:{width:"100%"},min:0,"controls-position":"right",modelValue:t(e).putbox,"onUpdate:modelValue":n[4]||(n[4]=u=>t(e).putbox=u),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),o(l,{label:"底仓:(SOUL)",prop:"putsoul",class:"w-full"},{default:r(()=>[o(a,{style:{width:"100%"},min:0,"controls-position":"right",modelValue:t(e).putsoul,"onUpdate:modelValue":n[5]||(n[5]=u=>t(e).putsoul=u),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),o(l,{label:"用户分成比列(%):",prop:"proportion",class:"w-full"},{default:r(()=>[o(a,{style:{width:"100%"},min:1,max:100,"controls-position":"right",modelValue:t(e).proportion,"onUpdate:modelValue":n[6]||(n[6]=u=>t(e).proportion=u),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),B("div",re,[o(v,{class:"w-[20%]",type:"info",onClick:n[7]||(n[7]=u=>C())},{default:r(()=>[b(" 取消 ")]),_:1}),o(v,{class:"w-[20%]",type:"success",loading:t(g),onClick:n[8]||(n[8]=u=>("throttle"in m?m.throttle:t(ae))(()=>{U(t(c))}))},{default:r(()=>[b(" 保存 ")]),_:1},8,["loading"])])]),_:1},8,["model","rules"])]),_:1},8,["model-value"])]),_:1})])}}});const ie=j(se,[["__scopeId","data-v-b7eb4cfa"]]),ue={class:"w-full h-[75vh] flex flex-col justify-between space-y-5"},pe={key:0,class:"flex items-center justify-end"},de={class:"flex justify-end"},me=A({__name:"index",props:{status:{default:1}},setup($){const p=$,d=x(!1),g=x({}),c=x(!1),_=k({content:[],status:0}),e=k({page:1,limit:20,status:p.status,asc:1}),w=async()=>{try{c.value=!0,p.status==1?e.asc=0:e.asc=1;const a=await le(e);c.value=!1,a.code===200?(_.content=a.data,_.totalElements=a.total):(_.content=[],_.totalElements=0,T({message:a.msg,grouping:!0,type:"error"}))}catch{c.value=!1}},U=a=>{e.page=a,w()},C=a=>(a/3600).toFixed(1),D=a=>{e.limit=a,w()},m=a=>{d.value=!0,g.value=a},n=a=>{const l=new Date(a*1e3);return`${l.getFullYear()}-${(l.getMonth()+1).toString().padStart(2,"0")}-${l.getDate().toString().padStart(2,"0")} ${l.getHours().toString().padStart(2,"0")}:${l.getMinutes().toString().padStart(2,"0")}:${l.getSeconds().toString().padStart(2,"0")}`};return R(()=>{w()}),(a,l)=>{const v=z,i=H,E=X,F=Y,u=J,I=ie,L=K;return y(),S("div",ue,[p.status==0?(y(),S("div",pe,[o(v,{class:"w-[100px]",type:"success",onClick:l[0]||(l[0]=s=>m(null))},{default:r(()=>[b(" 创建 ")]),_:1})])):V("",!0),G((y(),h(F,{ref:"multipleTableRef",class:"w-full flex-1",data:t(_).content,border:""},{default:r(()=>[o(i,{label:"纪元-时代",align:"center"},{default:r(s=>[b(" Epoch "+f(s.row.epoch_id)+" Age "+f(s.row.phase_id)+" ("+f(C(s.row.duration))+"h) ",1)]),_:1}),o(i,{label:"底价(USD)",prop:"price",align:"center"},{default:r(s=>[b(f(parseFloat((s.row.price/1e6).toFixed(2)))+"U ",1)]),_:1}),o(i,{label:"底仓(USD)",prop:"putmoney",align:"center"},{default:r(s=>[b(f(parseFloat((s.row.putmoney/1e6).toFixed(2)))+"U ",1)]),_:1}),o(i,{label:"底仓(BOX)",prop:"putbox",align:"center"}),o(i,{label:"底仓(SOUL)",prop:"putsoul",align:"center"}),o(i,{label:"用户分成比列(%)",prop:"proportion",align:"center"}),o(i,{prop:"eliminated",label:"淘汰",align:"center"},{default:r(s=>[b(f(("batType"in a?a.batType:t(q))(s.row.eliminated)[0]),1)]),_:1}),o(i,{prop:"mainstream",label:"进化",align:"center"},{default:r(s=>[b(f(("batType"in a?a.batType:t(q))(s.row.mainstream)[0]),1)]),_:1}),p.status==1?(y(),h(i,{key:0,label:"开始时间~结束时间",align:"center","show-overflow-tooltip":""},{default:r(s=>[b(f(n(s.row.timestamp))+" ~ "+f(n(s.row.timestamp+s.row.duration)),1)]),_:1})):V("",!0),p.status==0?(y(),h(i,{key:1,label:"操作",align:"center"},{default:r(s=>[o(E,{type:"success",onClick:ge=>m(s.row)},{default:r(()=>[b("编辑")]),_:2},1032,["onClick"])]),_:1})):V("",!0)]),_:1},8,["data"])),[[L,t(c)]]),B("div",de,[o(u,{"current-page":t(e).page,"onUpdate:currentPage":l[1]||(l[1]=s=>t(e).page=s),"page-size":t(e).limit,"onUpdate:pageSize":l[2]||(l[2]=s=>t(e).limit=s),"page-sizes":[20,50,100,500,1e3],layout:"total, sizes, prev, pager, next, jumper",total:t(_).totalElements,onCurrentChange:U,onSizeChange:D},null,8,["current-page","page-size","total"])]),o(I,{"dialog-visible":t(d),"onUpdate:closeDialog":l[3]||(l[3]=s=>d.value=!1),"onUpdate:success":l[4]||(l[4]=s=>w()),item:t(g)},null,8,["dialog-visible","item"])])}}});const ce=j(me,[["__scopeId","data-v-cd1c09e7"]]),_e={class:"w-full h-full text-[#EBEBEB] pt-10 px-5"},ze=A({__name:"deep-cycle",setup($){x(!1);const p=x("1");return(d,g)=>{const c=ce,_=W,e=Z;return y(),S("div",_e,[o(e,{modelValue:t(p),"onUpdate:modelValue":g[0]||(g[0]=w=>Q(p)?p.value=w:null),class:"w-full h-full"},{default:r(()=>[o(_,{label:"进行中",name:"1"},{default:r(()=>[t(p)=="1"?(y(),h(c,{key:0,status:t(p)},null,8,["status"])):V("",!0)]),_:1}),o(_,{label:"未开始",name:"0"},{default:r(()=>[t(p)=="0"?(y(),h(c,{key:0,status:t(p)},null,8,["status"])):V("",!0)]),_:1})]),_:1},8,["modelValue"])])}}});export{ze as default};
