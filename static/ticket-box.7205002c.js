import{d as F,r as i,e as V,t as I,o as p,c as T,f as t,w as a,u as e,g as y,v as g,x,D as A,y as $,h as R,k as M,j as P,a4 as z,l as H,m as O,z as D,A as J,C as N,p as K,a as Q,b as S,_ as W,q as X,F as Y,G as Z,H as ee}from"./entry.b2c9c439.js";/* empty css                        *//* empty css                 *//* empty css                *//* empty css                  *//* empty css                 *//* empty css               */import"./el-tooltip.4ed993c7.js";/* empty css                     *//* empty css                   */import{I as te,J as oe}from"./adminManage.8a2ce031.js";import{t as ae}from"./throttle.46d02480.js";import{a as j}from"./index.0b53fe87.js";/* empty css                */import"./request.5a526939.js";const le=b=>(K("data-v-43adec88"),b=b(),Q(),b),ne={class:"text-[#EBEBEB] pt-10"},se={class:"cursor-pointer hover:text-[#ebebeb]"},re=le(()=>S("span",{class:"iconfont icon-icon-copy"},null,-1)),ce=F({__name:"Box",setup(b){const l=i(!1),n=i(!1),m=i(),o=i(),_=V({content:[]}),c=i(),h=V({number:[{required:!0,message:"请输入票盒数量",trigger:"blur"}]}),s=V({number:null,activity:!1}),B=r=>{r&&r.resetFields()},d=async r=>{r&&(n.value||await r.validate(async(u,U)=>{if(u)try{n.value=!0;const f=await te({number:s.number,activity:s.activity}),{cdkeys:C,activity:w}=f.data;o.value=w,f.code===200?(R.success({message:"创建成功",grouping:!0,type:"success"}),_.content=C.map(([k,E])=>({cdkey:k,numberOfTimes:E})),m.value=_.content.map(k=>k.cdkey).join(`
`)):R.error({message:f.msg,grouping:!0,type:"error"})}catch{}finally{n.value=!1,B(r)}}))};return(r,u)=>{const U=M,f=P,C=z,w=H,k=O,E=D,q=J,L=I("copy"),G=N;return p(),T("div",ne,[t(k,{ref_key:"ruleFormRef",ref:c,inline:!1,"label-position":"right","label-width":"150px",model:e(s),rules:e(h),class:"flex w-fit"},{default:a(()=>[t(f,{label:"票盒数:",prop:"number"},{default:a(()=>[t(U,{min:1,max:200,style:{width:"240px"},"controls-position":"right",modelValue:e(s).number,"onUpdate:modelValue":u[0]||(u[0]=v=>e(s).number=v),placeholder:"请输入需要创建的票盒数量",clearable:""},null,8,["modelValue"])]),_:1}),t(f,{label:"是否生成活动代码:",prop:"activity"},{default:a(()=>[t(C,{modelValue:e(s).activity,"onUpdate:modelValue":u[1]||(u[1]=v=>e(s).activity=v),class:"ml-2","active-text":"是","inline-prompt":"","inactive-text":"否",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"}},null,8,["modelValue"])]),_:1}),t(w,{type:"success",loading:e(n),class:"ml-3",onClick:u[2]||(u[2]=v=>("throttle"in r?r.throttle:e(ae))(()=>{d(e(c))}))},{default:a(()=>[y(" 创建 ")]),_:1},8,["loading"]),g((p(),x(w,{type:"primary"},{default:a(()=>[y(" 复制所有票盒cdkey ")]),_:1})),[[L,e(m)]]),e(o)?g((p(),x(w,{key:0,type:"primary"},{default:a(()=>[y(" 复制活动代码 ")]),_:1})),[[L,`${("getJumpURL"in r?r.getJumpURL:e(j))()}/trainingTickets/ticket?activity=${e(o)}`]]):A("",!0)]),_:1},8,["model","rules"]),g((p(),x(q,{ref:"multipleTableRef",height:"650px",data:e(_).content,border:""},{default:a(()=>[t(E,{prop:"cdkey",label:"cdkey",align:"center"},{default:a(v=>[g((p(),T("div",se,[y($(v.row.cdkey)+" ",1),re])),[[L,v.row.cdkey]])]),_:1}),t(E,{prop:"numberOfTimes",label:"次数",align:"center"})]),_:1},8,["data"])),[[G,e(l)]])])}}});const ie=W(ce,[["__scopeId","data-v-43adec88"]]),pe={class:"w-full h-[85vh] flex flex-col justify-between space-y-5 p-5"},ue={class:"cursor-pointer hover:text-[#ebebeb]"},me=S("span",{class:"iconfont icon-icon-copy"},null,-1),_e=F({__name:"ActivityList",setup(b){i(!1);const l=i(!1);i(!1),i();const n=V({content:[]}),m=async()=>{try{l.value=!0;const o=await oe();l.value=!1,o.code===200?(n.content=o.data,n.totalElements=o.total):(n.content=[],n.totalElements=0,R({message:o.msg,grouping:!0,type:"error"}))}catch{l.value=!1}};return X(()=>{m()}),(o,_)=>{const c=D,h=J,s=I("copy"),B=N;return p(),T("div",pe,[g((p(),x(h,{ref:"multipleTableRef",class:"w-full flex-1",data:e(n).content,border:""},{default:a(()=>[t(c,{label:"时间",prop:"created_time",align:"center","show-overflow-tooltip":""}),t(c,{label:"活动代码",prop:"activity",align:"center","show-overflow-tooltip":""},{default:a(d=>[g((p(),T("div",ue,[y($(d.row.activity)+" ",1),me])),[[s,`${("getJumpURL"in o?o.getJumpURL:e(j))()}/trainingTickets?activity=${d.row.activity}`]])]),_:1}),t(c,{label:"总数",prop:"count",align:"center","show-overflow-tooltip":""}),t(c,{label:"已用",prop:"used",align:"center","show-overflow-tooltip":""}),t(c,{label:"未用",prop:"count",align:"center","show-overflow-tooltip":""},{default:a(d=>[y($(d.row.count-d.row.used),1)]),_:1})]),_:1},8,["data"])),[[B,e(l)]])])}}}),de={class:"w-full h-full flex flex-col space-y-2 p-6"},$e=F({__name:"ticket-box",setup(b){const l=i("2");return(n,m)=>{const o=ie,_=Z,c=_e,h=ee;return p(),T("div",de,[t(h,{modelValue:e(l),"onUpdate:modelValue":m[0]||(m[0]=s=>Y(l)?l.value=s:null),class:"w-full h-full bg-black"},{default:a(()=>[t(_,{label:"创建票盒",name:"2"},{default:a(()=>[t(o)]),_:1}),t(_,{label:"票盒活动列表",name:"3"},{default:a(()=>[e(l)=="3"?(p(),x(c,{key:0,level:e(l)},null,8,["level"])):A("",!0)]),_:1})]),_:1},8,["modelValue"])])}}});export{$e as default};
