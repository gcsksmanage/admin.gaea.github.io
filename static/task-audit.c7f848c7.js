import{T as I,U as F,d as B,V,W as re,r as R,q as U,S as se,X as O,Y as ie,Z as ce,$ as ue,a0 as de,a1 as pe,a2 as fe,e as P,o as C,c as j,f as t,w as i,b as L,g as x,y as E,u,I as me,J as _e,x as S,E as M,h as $,L as ge,K as ve,j as he,m as be,l as H,n as we,_ as ye,s as X,v as K,z as W,a3 as G,N as J,A as Q,B as Y,C as Z,D,F as xe,G as ke,H as Ce}from"./entry.e03c5f43.js";import{_ as Te}from"./client-only.463ccf15.js";/* empty css                  *//* empty css                 *//* empty css               *//* empty css                     *//* empty css                *//* empty css                  *//* empty css                   *//* empty css                       */import{B as ee,C as Ee,D as Re}from"./adminManage.e1071d2b.js";import{t as Se}from"./throttle.46d02480.js";/* empty css                 *//* empty css                   */import"./el-tooltip.4ed993c7.js";/* empty css                      *//* empty css                   */import{s as te}from"./index.0b53fe87.js";/* empty css                */import"./request.e2cf9005.js";const z=globalThis.requestIdleCallback||(s=>{const n=Date.now(),_={didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-n))};return setTimeout(()=>{s(_)},1)}),Le=globalThis.cancelIdleCallback||(s=>{clearTimeout(s)}),$e=s=>{const n=I();n.isHydrating?n.hooks.hookOnce("app:suspense:resolve",()=>{z(s)}):z(s)};async function ae(s,n=F()){const{path:_,matched:e}=n.resolve(s);if(!e.length||(n._routePreloaded||(n._routePreloaded=new Set),n._routePreloaded.has(_)))return;const r=n._preloadPromises=n._preloadPromises||[];if(r.length>4)return Promise.all(r).then(()=>ae(s,n));n._routePreloaded.add(_);const d=e.map(l=>{var h;return(h=l.components)==null?void 0:h.default}).filter(l=>typeof l=="function");for(const l of d){const h=Promise.resolve(l()).catch(()=>{}).finally(()=>r.splice(r.indexOf(h)));r.push(h)}await Promise.all(r)}const Pe=(...s)=>s.find(n=>n!==void 0),Ae="noopener noreferrer";/*! @__NO_SIDE_EFFECTS__ */function je(s){const n=s.componentName||"NuxtLink",_=(e,r)=>{if(!e||s.trailingSlash!=="append"&&s.trailingSlash!=="remove")return e;const d=s.trailingSlash==="append"?de:pe;if(typeof e=="string")return d(e,!0);const l="path"in e?e.path:r(e).path;return{...e,name:void 0,path:d(l,!0)}};return B({name:n,props:{to:{type:[String,Object],default:void 0,required:!1},href:{type:[String,Object],default:void 0,required:!1},target:{type:String,default:void 0,required:!1},rel:{type:String,default:void 0,required:!1},noRel:{type:Boolean,default:void 0,required:!1},prefetch:{type:Boolean,default:void 0,required:!1},noPrefetch:{type:Boolean,default:void 0,required:!1},activeClass:{type:String,default:void 0,required:!1},exactActiveClass:{type:String,default:void 0,required:!1},prefetchedClass:{type:String,default:void 0,required:!1},replace:{type:Boolean,default:void 0,required:!1},ariaCurrentValue:{type:String,default:void 0,required:!1},external:{type:Boolean,default:void 0,required:!1},custom:{type:Boolean,default:void 0,required:!1}},setup(e,{slots:r}){const d=F(),l=V(()=>{const c=e.to||e.href||"";return _(c,d.resolve)}),h=V(()=>e.external||e.target&&e.target!=="_self"?!0:typeof l.value=="object"?!1:l.value===""||re(l.value,{acceptRelative:!0})),y=R(!1),p=R(null),b=c=>{var f;p.value=e.custom?(f=c==null?void 0:c.$el)==null?void 0:f.nextElementSibling:c==null?void 0:c.$el};if(e.prefetch!==!1&&e.noPrefetch!==!0&&e.target!=="_blank"&&!De()){const f=I();let a,o=null;U(()=>{const m=Be();$e(()=>{a=z(()=>{var k;(k=p==null?void 0:p.value)!=null&&k.tagName&&(o=m.observe(p.value,async()=>{o==null||o(),o=null;const w=typeof l.value=="string"?l.value:d.resolve(l.value).fullPath;await Promise.all([f.hooks.callHook("link:prefetch",w).catch(()=>{}),!h.value&&ae(l.value,d).catch(()=>{})]),y.value=!0}))})})}),se(()=>{a&&Le(a),o==null||o(),o=null})}return()=>{var m,k;if(!h.value){const w={ref:b,to:l.value,activeClass:e.activeClass||s.activeClass,exactActiveClass:e.exactActiveClass||s.exactActiveClass,replace:e.replace,ariaCurrentValue:e.ariaCurrentValue,custom:e.custom};return e.custom||(y.value&&(w.class=e.prefetchedClass||s.prefetchedClass),w.rel=e.rel),O(ie("RouterLink"),w,r.default)}const c=typeof l.value=="object"?((m=d.resolve(l.value))==null?void 0:m.href)??null:l.value||null,f=e.target||null,a=e.noRel?null:Pe(e.rel,s.externalRelAttribute,c?Ae:"")||null,o=()=>fe(c,{replace:e.replace});return e.custom?r.default?r.default({href:c,navigate:o,get route(){if(!c)return;const w=ce(c);return{path:w.pathname,fullPath:w.pathname,get query(){return ue(w.search)},hash:w.hash,params:{},name:void 0,matched:[],redirectedFrom:void 0,meta:{},href:c}},rel:a,target:f,isExternal:h.value,isActive:!1,isExactActive:!1}):null:O("a",{ref:p,href:c,rel:a,target:f},(k=r.default)==null?void 0:k.call(r))}}})}const le=je({componentName:"NuxtLink"});function Be(){const s=I();if(s._observer)return s._observer;let n=null;const _=new Map,e=(d,l)=>(n||(n=new IntersectionObserver(h=>{for(const y of h){const p=_.get(y.target);(y.isIntersecting||y.intersectionRatio>0)&&p&&p()}})),_.set(d,l),n.observe(d),()=>{_.delete(d),n.unobserve(d),_.size===0&&(n.disconnect(),n=null)});return s._observer={observe:e}}function De(){const s=navigator.connection;return!!(s&&(s.saveData||/2g/.test(s.effectiveType)))}const Ne={class:"text-[#ebebeb] text-[16px] mb-5"},qe={class:"text-red-500"},ze={class:"w-full flex justify-end mt-5"},Ie=B({__name:"Reject",props:{dialogVisible:{type:Boolean,default:!1},item:{default:""}},emits:["update:closeDialog","update:success"],setup(s,{emit:n}){const _=s,e=R(),r=R(!1),d=R([{value:"Repetitive or overly similar content"},{value:"Low view count"},{value:"Contains prohibited content (e.g., ads, sensitive information, etc.)"},{value:"Fails to reflect GAEA-related topics or value"},{value:"Invalid or missing images/links"},{value:"The uploaded Discord account does not match the one that is linked."},{value:"Empty text or uploaded file is blank"},{value:"Incomplete task submission"},{value:"Use of auto-generated or non-original content"},{value:"Unclear or vague language expression"}]),l=P({reason:""}),h=f=>/^[^\u4e00-\u9fa5]*$/.test(f)&&f.length<=128,y=P({reason:[{required:!0,message:"驳回原因为必填项",trigger:"change"},{validator:(f,a,o)=>{a&&!h(a)?o(new Error("仅限英文内容，且长度不得超过128字符")):o()},trigger:"blur"}]}),p=()=>{n("update:closeDialog"),l.reason=""},b=f=>{l.reason=f.target.value},c=async f=>{f&&await f.validate(async(a,o)=>{a&&M.confirm(`驳回用户名为：${_.item.username} 的申请`,"Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{try{r.value=!0;const m=await ee({id:_.item.id,status:-2,reason:l.reason});m.code===200?($.success(m.data),n("update:success"),p()):$.error(m.msg)}catch{}finally{r.value=!1}}).catch(()=>{$({type:"info",message:"canceled"})})})};return(f,a)=>{const o=ge,m=ve,k=he,w=be,v=H,A=we,N=Te;return C(),j("div",null,[t(N,null,{default:i(()=>[t(A,{draggable:"","model-value":f.$props.dialogVisible,style:{"background-color":"black",border:"1px  #ebebeb solid","border-radius":"10px","padding-bottom":"30px"},title:"",width:"550px",class:"px-10","align-center":"",onClose:p},{default:i(()=>[L("p",Ne,[x("驳回用户名为："),L("span",qe,E(_.item.username),1),x(" 的申请")]),t(w,{ref_key:"ruleFormRef",ref:e,class:"w-full p-5",inline:!0,"label-position":"right","label-width":"70px",model:u(l),rules:u(y)},{default:i(()=>[t(k,{label:"数量:",prop:"reason",class:"w-full"},{default:i(()=>[t(m,{modelValue:u(l).reason,"onUpdate:modelValue":a[0]||(a[0]=T=>u(l).reason=T),clearable:"",filterable:"","allow-create":"","default-first-option":"",onInput:a[1]||(a[1]=T=>b(T)),"reserve-keyword":!1,placeholder:"请选择驳回原因",style:{height:"32px","border-radius":"50px",width:"250px"}},{default:i(()=>[(C(!0),j(me,null,_e(u(d),(T,q)=>(C(),S(o,{key:T.value,label:`${q+1}.${T.value}`,value:T.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),L("div",ze,[t(v,{class:"w-[20%]",type:"info",onClick:a[2]||(a[2]=T=>p())},{default:i(()=>[x(" 取消 ")]),_:1}),t(v,{loading:u(r),class:"w-[20%]",type:"danger",onClick:a[3]||(a[3]=T=>("throttle"in f?f.throttle:u(Se))(()=>{c(u(e))}))},{default:i(()=>[x(" 驳回 ")]),_:1},8,["loading"])])]),_:1},8,["model-value"])]),_:1})])}}});const Ue=ye(Ie,[["__scopeId","data-v-4e57579a"]]),Ve={class:"w-full h-full flex flex-col space-y-2 p-2"},Oe={class:"w-full flex-1 overflow-y-auto"},Fe={class:"flex justify-end"},Me=B({__name:"Index",props:{level:{default:""}},setup(s){const n=s,_=R(),e=R(!1),r=R(!1),d=P({content:[],totalElements:0}),l=P({level:Number(n.level),page:1,limit:20}),h=a=>{l.page=a,b()},y=a=>{l.limit=a,b()},p=a=>{const k=new URL(a).pathname.split("_");return k[k.length-1]},b=async()=>{try{r.value=!0;const a={...l},o=await Ee(a);r.value=!1,o.code&&(d.content=o.data.map(m=>({...m,passThroughLoading:!1,rejectLoading:!1})),d.totalElements=o.total)}catch{r.value=!1}finally{r.value=!1}},c=a=>{M.confirm(`通过用户名为：${a.username} 的申请`,"Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{try{a.passThroughLoading=!0;const o=await ee({id:a.id,status:2,reason:""});a.passThroughLoading=!1,o.code===200?($.success(o.data),b()):$.error(o.msg)}catch{}finally{a.passThroughLoading=!1}}).catch(()=>{$({type:"info",message:"canceled"})})},f=a=>{_.value=a,e.value=!0};return U(async()=>{await X(),b()}),(a,o)=>{const m=W,k=G,w=le,v=J,A=H,N=Q,T=Y,q=Ue,ne=Z;return C(),j("div",Ve,[L("div",Oe,[K((C(),S(N,{ref:"multipleTableRef",height:"550px",data:u(d).content,border:"",style:{height:"100%"},"header-cell-style":{background:"#e0eeee"}},{default:i(()=>[t(m,{prop:"userid",label:"用户ID",align:"center",width:"140px",sortable:""}),t(m,{prop:"username",label:"用户名",align:"center",width:"150px","show-overflow-tooltip":"",sortable:""}),t(m,{prop:"created_time",label:"上传时间",align:"center",width:"150px",sortable:"","show-overflow-tooltip":""}),t(m,{prop:"type",label:"勋章",align:"center",sortable:""},{default:i(g=>[t(k,{type:g.row.type===1?"success":g.row.type===2?"warning":"danger",size:"small",effect:"dark"},{default:i(()=>[x(E(g.row.type===1?"一级":g.row.type===2?"二级":"三级"),1)]),_:2},1032,["type"])]),_:1}),t(m,{prop:"medal_id",label:"任务id",align:"center","min-width":"100px",sortable:""}),t(m,{prop:"code",label:"任务代号",align:"center","min-width":"120px",sortable:""}),t(m,{prop:"social_x_name",label:"社交X名称",align:"center","min-width":"130px","show-overflow-tooltip":""},{default:i(g=>[x(E(g.row.social_x_name||"未绑定"),1)]),_:1}),t(m,{prop:"social_dc_name",label:"Discord名称",align:"center","min-width":"140px","show-overflow-tooltip":""},{default:i(g=>[x(E(g.row.social_dc_name||"未绑定"),1)]),_:1}),t(m,{prop:"url",label:"文件",align:"center",width:"150","show-overflow-tooltip":""},{default:i(g=>[t(v,{class:"box-item",title:"",content:`${p(g.row.url)}`,placement:"top-start"},{reference:i(()=>[t(w,{to:g.row.url,target:"_blank",rel:"noopener",class:"hover:underline underline-offset-4 u-line-1"},{default:i(()=>[x(E(("stringStar"in a?a.stringStar:u(te))({value:p(g.row.url),characters:"***",start:4,end:7})),1)]),_:2},1032,["to"])]),_:2},1032,["content"])]),_:1}),t(m,{label:"操作",width:"320",fixed:"right",align:"center"},{default:i(g=>[t(w,{to:g.row.url,target:"_blank",rel:"noopener",class:"mr-3"},{default:i(()=>[t(A,{type:"primary"},{default:i(()=>[x("查看")]),_:1})]),_:2},1032,["to"]),t(A,{type:"success",loading:g.row.passThroughLoading,onClick:oe=>c(g.row)},{default:i(()=>[x("通过")]),_:2},1032,["loading","onClick"]),t(A,{type:"danger",loading:g.row.rejectLoading,onClick:oe=>f(g.row)},{default:i(()=>[x("驳回")]),_:2},1032,["loading","onClick"])]),_:1})]),_:1},8,["data"])),[[ne,u(r)]]),L("div",Fe,[t(T,{"current-page":u(l).page,"onUpdate:currentPage":o[0]||(o[0]=g=>u(l).page=g),"page-size":u(l).limit,"onUpdate:pageSize":o[1]||(o[1]=g=>u(l).limit=g),"page-sizes":[20,50,100,500,1e3],layout:"total, sizes, prev, pager, next, jumper",total:u(d).totalElements,onCurrentChange:h,onSizeChange:y},null,8,["current-page","page-size","total"])])]),t(q,{"dialog-visible":u(e),"onUpdate:closeDialog":o[2]||(o[2]=g=>e.value=!1),item:u(_),"onUpdate:success":o[3]||(o[3]=g=>b())},null,8,["dialog-visible","item"])])}}}),He={class:"w-full h-full flex flex-col space-y-2 p-2"},Xe={class:"w-full flex-1 overflow-y-auto"},Ke={class:"flex justify-end"},We=B({__name:"Records",props:{level:{default:""}},setup(s){const n=s,_=R(!1),e=P({content:[],totalElements:0}),r=P({level:Number(n.level),page:1,limit:20}),d=p=>{r.page=p,y()},l=p=>{r.limit=p,y()},h=p=>{const f=new URL(p).pathname.split("_");return f[f.length-1]},y=async()=>{try{_.value=!0;const p={...r},b=await Re(p);_.value=!1,b.code&&(e.content=b.data,e.totalElements=b.total)}catch{_.value=!1}finally{_.value=!1}};return U(async()=>{await X(),y()}),(p,b)=>{const c=W,f=le,a=J,o=G,m=Q,k=Y,w=Z;return C(),j("div",He,[L("div",Xe,[K((C(),S(m,{ref:"multipleTableRef",height:"550px",data:u(e).content,border:"",style:{height:"100%"},"header-cell-style":{background:"#e0eeee"}},{default:i(()=>[t(c,{prop:"userid",label:"用户ID",align:"center",width:"140px",sortable:""}),t(c,{prop:"username",label:"用户名",align:"center",width:"150px","show-overflow-tooltip":"",sortable:""}),t(c,{prop:"created_time",label:"上传时间",align:"center",width:"150px",sortable:"","show-overflow-tooltip":""}),t(c,{prop:"medal_id",label:"任务id",align:"center","min-width":"100px",sortable:""}),t(c,{prop:"code",label:"任务代号",align:"center","min-width":"120px",sortable:""}),t(c,{prop:"social_x_name",label:"社交X名称",align:"center","min-width":"130px","show-overflow-tooltip":""},{default:i(v=>[x(E(v.row.social_x_name||"未绑定"),1)]),_:1}),t(c,{prop:"social_dc_name",label:"Discord名称",align:"center","min-width":"140px","show-overflow-tooltip":""},{default:i(v=>[x(E(v.row.social_dc_name||"未绑定"),1)]),_:1}),t(c,{prop:"url",label:"文件",align:"center",width:"150","show-overflow-tooltip":""},{default:i(v=>[t(a,{class:"box-item",title:"",content:`${h(v.row.url)}`,placement:"top-start"},{reference:i(()=>[t(f,{to:v.row.url,target:"_blank",rel:"noopener",class:"hover:underline underline-offset-4 u-line-1"},{default:i(()=>[x(E(("stringStar"in p?p.stringStar:u(te))({value:h(v.row.url),characters:"***",start:4,end:7})),1)]),_:2},1032,["to"])]),_:2},1032,["content"])]),_:1}),t(c,{prop:"status",label:"审核状体",align:"center"},{default:i(v=>[t(o,{type:v.row.status===2?"success":"danger",size:"small",effect:"dark"},{default:i(()=>[x(E(v.row.status===2?"通过":"驳回"),1)]),_:2},1032,["type"])]),_:1}),t(c,{prop:"note",label:"原因",align:"center","min-width":"100px","show-overflow-tooltip":""},{default:i(v=>[x(E(v.row.note||"-"),1)]),_:1})]),_:1},8,["data"])),[[w,u(_)]]),L("div",Ke,[t(k,{"current-page":u(r).page,"onUpdate:currentPage":b[0]||(b[0]=v=>u(r).page=v),"page-size":u(r).limit,"onUpdate:pageSize":b[1]||(b[1]=v=>u(r).limit=v),"page-sizes":[20,50,100,500,1e3],layout:"total, sizes, prev, pager, next, jumper",total:u(e).totalElements,onCurrentChange:d,onSizeChange:l},null,8,["current-page","page-size","total"])])])])}}}),Ge={class:"w-full h-full flex flex-col space-y-2 p-6"},gt=B({__name:"task-audit",setup(s){const n=R("2");return(_,e)=>{const r=Me,d=ke,l=We,h=Ce;return C(),j("div",Ge,[t(h,{modelValue:u(n),"onUpdate:modelValue":e[0]||(e[0]=y=>xe(n)?n.value=y:null),class:"w-full h-full bg-black"},{default:i(()=>[t(d,{label:"待审核 - 等级 2",name:"2"},{default:i(()=>[u(n)==="2"?(C(),S(r,{key:0,level:2})):D("",!0)]),_:1}),t(d,{label:"待审核 - 等级 3",name:"3"},{default:i(()=>[u(n)==="3"?(C(),S(r,{key:0,level:3})):D("",!0)]),_:1}),t(d,{label:"已审核 - 等级 2",name:"4"},{default:i(()=>[u(n)==="4"?(C(),S(l,{key:0,level:2})):D("",!0)]),_:1}),t(d,{label:"已审核 - 等级 3",name:"5"},{default:i(()=>[u(n)==="5"?(C(),S(l,{key:0,level:3})):D("",!0)]),_:1})]),_:1},8,["modelValue"])])}}});export{gt as default};
