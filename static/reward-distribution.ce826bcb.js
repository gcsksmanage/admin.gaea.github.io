import{d as S,r as E,e as R,R as A,o as u,c as g,b as V,f as d,w as n,u as a,v as k,q as v,J as U,K as P,g as c,E as f,h as F,i as C,P as q,j,k as z,l as G,t as I,p as J,a as K,O as L,_ as M}from"./entry.7a5a578c.js";/* empty css                 *//* empty css                *//* empty css                       *//* empty css                        *//* empty css                  */import{G as H,H as O,I as Q,J as W,K as X,L as Y}from"./adminManage.defe7474.js";import{t as Z}from"./throttle.46d02480.js";import"./request.c0233501.js";const ee=m=>(J("data-v-cf75e298"),m=m(),K(),m),te={class:"w-full h-full overflow-auto"},re={class:"w-fit h-full text-[#EBEBEB] pl-10 mt-10"},le=ee(()=>V("p",{class:"text-red-500 text-[12px] ml-24 mb-2"},"Note: Multiple accounts separated by commas",-1)),ae={class:"w-full flex justify-end"},se=S({__name:"reward-distribution",setup(m){const b=E(),B=[{value:1,key:1,label:"snft"},{value:2,key:2,label:"anft"},{value:3,key:3,label:"milestone"},{value:4,key:4,label:"audioVisual"},{value:5,key:5,label:"event"}],x=[{value:"points",key:"points",label:"Points",api:H,min:1,max:1e4},{value:"soul",key:"soul",label:"Soul Points",api:O,min:1,max:500},{value:"number",key:"blindbox",label:"Blind Box",api:Q,min:1,max:200},{value:"number",key:"ticketbox",label:"Ticket Box",api:W,min:1,max:200},{value:"sxp",key:"sxp",label:"sxp",api:r=>{if(r.addrs&&r.addrs.trim()!==""){const t=r.addrs.split(",").map(l=>l.trim()).join(","),o={};return r.addrs.split(",").forEach(l=>{o[l.trim()]=Number(r.sxp)}),X({airdrop_type:r.airdrop_type||0,airdrop_task:r.airdrop_task||"",addrs:t,sxp:Number(r.sxp),addr_sxp_map:o})}else{const t={};return r.uids.split(",").forEach(o=>{t[o.trim()]=Number(r.sxp)}),Y({airdrop_type:r.airdrop_type||0,airdrop_task:r.airdrop_task||"",uids:r.uids,sxp:Number(r.sxp),user_sxp_map:t})}},min:1,max:1e4}],N=R({uids:[{required:!0,message:"Please enter User ID",trigger:"blur"},{validator:(r,t,o)=>{if(!t.trim()){o(new Error("Please enter User ID"));return}const l=t.split(",").map(i=>i.trim());for(const i of l){if(!/^\d+$/.test(i)){o(new Error("UID format error, must be numeric"));return}if(i.length!==14){o(new Error("UID length must be 14 digits"));return}}o()},trigger:"blur"}],airdrop_task:[{required:!0,message:"Please enter event type",trigger:"blur"}],num:[{required:!0,message:"Please enter",trigger:"blur"},{validator:(r,t,o)=>{const l=x.find(i=>i.key===e.type);l&&(t<l.min||t>l.max)?o(new Error(`${l.label} count should be between ${l.min} and ${l.max}`)):o()},trigger:"blur"}],type:[{required:!0,message:"Please select reward type",trigger:"change"}]}),y=E(!1),e=R({uids:"",addrs:"",type:"points",num:1,points:null,soul:null,sxp:null,blindbox:null,ticketbox:null,description:"",airdrop_type:"",airdrop_task:""});A(()=>e.type,r=>{r!==void 0&&(e.num=1)});const h=r=>{r&&r.resetFields()},D=async r=>{r&&(y.value||await r.validate(async(t,o)=>{if(!t)return;const l=x.find(i=>i.key===e.type);if(!l){f.error("Corresponding reward type not found");return}try{y.value=!0;let i;if(e.type==="sxp"){const p={uids:e.uids,addrs:e.addrs,sxp:e.num,airdrop_type:e.airdrop_type,airdrop_task:e.airdrop_task};i=await l.api(p)}else{const w={uids:e.uids.split(",").map(_=>`${_.trim()}`).join(","),[l.value]:Number(e.num)};i=await l.api(w)}i.code===200?f.success(`${l.label} reward distributed successfully,${i.data}`):f.error(i.msg||"Reward distribution failed")}catch{f.error("Reward distribution failed, please try again later")}finally{y.value=!1,h(r)}}))};return(r,t)=>{const o=F,l=C,i=L,p=q,w=j,_=z,T=G;return u(),g("div",te,[V("div",re,[d(T,{ref_key:"ruleFormRef",ref:b,inline:!0,"label-position":"right","label-width":"150px",model:a(e),rules:a(N),class:"flex flex-col w-fit"},{default:n(()=>[le,d(l,{label:"User ID:",class:"w-[705px]"},{default:n(()=>[d(o,{type:"textarea",autosize:{minRows:2,maxRows:25},style:{width:"100%"},"controls-position":"right",modelValue:a(e).uids,"onUpdate:modelValue":t[0]||(t[0]=s=>a(e).uids=s),placeholder:"Please enter",clearable:""},null,8,["modelValue"])]),_:1}),a(e).type==="sxp"?(u(),k(l,{key:0,label:"Wallet Address:",prop:"addrs",class:"w-[470px]"},{default:n(()=>[d(o,{autosize:"",type:"textarea",style:{width:"100%"},"controls-position":"right",modelValue:a(e).addrs,"onUpdate:modelValue":t[1]||(t[1]=s=>a(e).addrs=s),placeholder:"Please enter",clearable:""},null,8,["modelValue"])]),_:1})):v("",!0),d(l,{label:"Reward:",prop:"type"},{default:n(()=>[d(p,{modelValue:a(e).type,"onUpdate:modelValue":t[2]||(t[2]=s=>a(e).type=s)},{default:n(()=>[(u(),g(U,null,P(x,(s,$)=>d(i,{label:s.key,key:s.key},{default:n(()=>[c(I(s.label),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),a(e).type==="sxp"?(u(),k(l,{key:1,label:"Resend Type:",prop:"type"},{default:n(()=>[d(p,{modelValue:a(e).airdrop_type,"onUpdate:modelValue":t[3]||(t[3]=s=>a(e).airdrop_type=s)},{default:n(()=>[(u(),g(U,null,P(B,(s,$)=>d(i,{label:s.key,key:s.key},{default:n(()=>[c(I(s.label),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1})):v("",!0),a(e).type==="sxp"&&a(e).airdrop_type===3||a(e).airdrop_type===4||a(e).airdrop_type===5?(u(),k(l,{key:2,label:"Event Type:",prop:"airdrop_task"},{default:n(()=>[d(o,{autosize:"",style:{width:"100%"},"controls-position":"right",modelValue:a(e).airdrop_task,"onUpdate:modelValue":t[4]||(t[4]=s=>a(e).airdrop_task=s),placeholder:"Please enter",clearable:""},null,8,["modelValue"])]),_:1})):v("",!0),d(l,{label:"Quantity:",prop:"num",class:"w-[350px]"},{default:n(()=>[d(w,{min:1,max:1e4,"controls-position":"right",modelValue:a(e).num,"onUpdate:modelValue":t[5]||(t[5]=s=>a(e).num=s),placeholder:"Please enter",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),V("div",ae,[d(_,{class:"w-[20%]",type:"danger",onClick:t[6]||(t[6]=s=>h(a(b)))},{default:n(()=>[c(" Reset ")]),_:1}),d(_,{class:"w-[20%]",type:"success",loading:a(y),onClick:t[7]||(t[7]=s=>("throttle"in r?r.throttle:a(Z))(()=>{D(a(b))}))},{default:n(()=>[c(" Distribute ")]),_:1},8,["loading"])])]),_:1},8,["model","rules"])])])}}});const fe=M(se,[["__scopeId","data-v-cf75e298"]]);export{fe as default};
