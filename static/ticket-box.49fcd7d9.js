import{d as L,r as i,e as h,t as N,o as u,c as E,f as n,w as o,u as e,g as _,v as f,x,D as S,y as U,h as T,k as J,j as $,l as j,m as A,z as q,A as z,C as G,p as M,a as O,b as P,_ as H}from"./entry.011860c9.js";/* empty css                        *//* empty css                 */import{t as K}from"./throttle.fca0157a.js";/* empty css                  *//* empty css                 *//* empty css                     *//* empty css                   */import{u as Q}from"./adminManage.6eea09cf.js";import{a as W}from"./index.afb82750.js";import"./request.cbc97653.js";const X=p=>(M("data-v-d49ce242"),p=p(),O(),p),Y={class:"text-[#EBEBEB] pt-10 px-5"},Z={class:"cursor-pointer hover:text-[#ebebeb]"},ee=X(()=>P("span",{class:"iconfont icon-copy"},null,-1)),te=L({__name:"ticket-box",setup(p){const V=i(!1),m=i(!1),w=i(),b=i(),y=h({content:[]}),B=i(),F=h({number:[{required:!0,message:"请输入票盒数量",trigger:"blur"}]}),d=h({number:null}),I=t=>{t&&t.resetFields()},R=async t=>{t&&(m.value||await t.validate(async(a,C)=>{if(a)try{m.value=!0;const r=await Q({number:d.number}),{cdkeys:l,activity:g}=r.data;b.value=g,r.code===200?(T.success({message:"创建成功",grouping:!0,type:"success"}),y.content=l.map(([s,v])=>({cdkey:s,numberOfTimes:v})),w.value=y.content.map(s=>s.cdkey).join(",")):T.error({message:r.msg,grouping:!0,type:"error"})}catch{}finally{m.value=!1,I(t)}}))};return(t,a)=>{const C=J,r=$,l=j,g=A,s=q,v=z,k=N("copy"),D=G;return u(),E("div",Y,[n(g,{ref_key:"ruleFormRef",ref:B,inline:!0,"label-position":"right","label-width":"90px",model:e(d),rules:e(F),class:"flex w-fit"},{default:o(()=>[n(r,{label:"票盒数:",prop:"number"},{default:o(()=>[n(C,{min:1,max:200,style:{width:"240px"},"controls-position":"right",modelValue:e(d).number,"onUpdate:modelValue":a[0]||(a[0]=c=>e(d).number=c),placeholder:"请输入需要创建的票盒数量",clearable:""},null,8,["modelValue"])]),_:1}),n(l,{class:"w-[20%]",type:"success",loading:e(m),onClick:a[1]||(a[1]=c=>("throttle"in t?t.throttle:e(K))(()=>{R(e(B))}))},{default:o(()=>[_(" 创建 ")]),_:1},8,["loading"]),f((u(),x(l,{type:"primary"},{default:o(()=>[_(" 复制所有票盒cdkey ")]),_:1})),[[k,e(w)]]),e(b)?f((u(),x(l,{key:0,type:"primary"},{default:o(()=>[_(" 复制活动代码 ")]),_:1})),[[k,`${("getJumpURL"in t?t.getJumpURL:e(W))()}/ticket/${e(b)}`]]):S("",!0)]),_:1},8,["model","rules"]),f((u(),x(v,{ref:"multipleTableRef",height:"650px",data:e(y).content,border:""},{default:o(()=>[n(s,{prop:"cdkey",label:"cdkey",align:"center"},{default:o(c=>[f((u(),E("div",Z,[_(U(c.row.cdkey)+" ",1),ee])),[[k,c.row.cdkey]])]),_:1}),n(s,{prop:"numberOfTimes",label:"次数",align:"center"})]),_:1},8,["data"])),[[D,e(V)]])])}}});const de=H(te,[["__scopeId","data-v-d49ce242"]]);export{de as default};
