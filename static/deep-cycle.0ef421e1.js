import{d as A,r as x,e as k,o as w,c as S,f as o,w as r,b as B,y as b,u as t,x as h,D as V,g as y,h as T,k as M,j as N,l as z,m as O,n as P,_ as j,q as R,v as G,z as H,M as X,A as Y,B as J,C as K,F as Q,G as W,H as Z}from"./entry.f0d8225f.js";import{_ as ee}from"./client-only.11eb4ac4.js";/* empty css                        *//* empty css                 *//* empty css                *//* empty css                  *//* empty css                   */import{h as te,i as oe,j as le}from"./adminManage.76229447.js";import{t as ae}from"./throttle.46d02480.js";/* empty css                 *//* empty css               *//* empty css                */import"./el-tooltip.4ed993c7.js";/* empty css                     *//* empty css                      *//* empty css                  *//* empty css                   */import{b as q}from"./index.0b53fe87.js";/* empty css                */import"./request.6174ed0e.js";const ne={class:"text-[#ebebeb] text-[16px]"},re={class:"w-full flex justify-end"},se=A({__name:"Add",props:{dialogVisible:{type:Boolean,default:!1},item:{default:null}},emits:["update:closeDialog","update:success"],setup($,{emit:u}){const p=$,f=x(!1),c=x(),_=k({number:[{required:!0,message:"请输入",trigger:"blur"}],duration:[{required:!0,message:"请输入",trigger:"blur"}],price:[{required:!0,message:"请输入",trigger:"blur"}],proportion:[{required:!0,message:"请输入",trigger:"blur"}],putbox:[{required:!0,message:"请输入",trigger:"blur"}],putsoul:[{required:!0,message:"请输入",trigger:"blur"}],putmoney:[{required:!0,message:"请输入",trigger:"blur"}]}),e=k({id:null,number:1,putmoney:300,putbox:1500,putsoul:6e3,price:.4,duration:24,proportion:50}),v=d=>{d&&d.resetFields()},U=async d=>{d&&(f.value||await d.validate(async(n,a)=>{if(n)try{f.value=!0;const g={id:p.item.period_id,number:e.number,putmoney:e.putmoney*1e6,putbox:e.putbox,putsoul:e.putsoul,price:e.price*1e6,duration:e.duration*3600,proportion:e.proportion};var l=null;g.id?(delete g.number,l=await te(g)):(delete g.id,l=await oe(g)),l.code===200?(T.success({message:"创建成功",grouping:!0,type:"success"}),u("update:success"),C()):T.error({message:l.msg,grouping:!0,type:"error"})}catch{}finally{f.value=!1,v(d)}}))},C=()=>{u("update:closeDialog"),v(c.value)},D=async()=>{p.item.period_id&&(e.id=p.item.period_id,e.putmoney=p.item.putmoney/1e6,e.putbox=p.item.putbox,e.putsoul=p.item.putsoul,e.price=p.item.price/1e6,e.duration=p.item.duration/3600,e.proportion=p.item.proportion)};return(d,n)=>{const a=M,l=N,g=z,m=O,E=P,F=ee;return w(),S("div",null,[o(F,null,{default:r(()=>[o(E,{draggable:"","model-value":d.$props.dialogVisible,style:{"background-color":"black",border:"1px  #ebebeb solid","border-radius":"10px","padding-bottom":"30px"},title:"",width:"500px",class:"px-10","align-center":"",onClose:C,onOpen:n[9]||(n[9]=i=>D())},{default:r(()=>[B("p",ne,b(t(e).id?`编辑 纪元 ${p.item.epoch_id} 时代 ${p.item.phase_id}`:"新增深度周期"),1),o(m,{ref_key:"ruleFormRef",ref:c,class:"w-full p-5",inline:!0,"label-position":"right","label-width":"140px",model:t(e),rules:t(_)},{default:r(()=>[t(e).id?V("",!0):(w(),h(l,{key:0,label:"数量:",prop:"number",class:"w-full"},{default:r(()=>[o(a,{style:{width:"100%"},min:1,max:200,"controls-position":"right",modelValue:t(e).number,"onUpdate:modelValue":n[0]||(n[0]=i=>t(e).number=i),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1})),o(l,{label:"时长(小时):",prop:"duration",class:"w-full"},{default:r(()=>[o(a,{style:{width:"100%"},min:0,max:100,"controls-position":"right",modelValue:t(e).duration,"onUpdate:modelValue":n[1]||(n[1]=i=>t(e).duration=i),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),o(l,{label:"底价(USD):",prop:"price",class:"w-full"},{default:r(()=>[o(a,{style:{width:"100%"},min:0,max:1,"controls-position":"right",modelValue:t(e).price,"onUpdate:modelValue":n[2]||(n[2]=i=>t(e).price=i),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),o(l,{label:"底仓:(USD)",prop:"putmoney",class:"w-full"},{default:r(()=>[o(a,{style:{width:"100%"},min:0,max:1e3,"controls-position":"right",modelValue:t(e).putmoney,"onUpdate:modelValue":n[3]||(n[3]=i=>t(e).putmoney=i),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),o(l,{label:"底仓:(BOX)",prop:"putbox",class:"w-full"},{default:r(()=>[o(a,{style:{width:"100%"},min:0,"controls-position":"right",modelValue:t(e).putbox,"onUpdate:modelValue":n[4]||(n[4]=i=>t(e).putbox=i),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),o(l,{label:"底仓:(SOUL)",prop:"putsoul",class:"w-full"},{default:r(()=>[o(a,{style:{width:"100%"},min:0,"controls-position":"right",modelValue:t(e).putsoul,"onUpdate:modelValue":n[5]||(n[5]=i=>t(e).putsoul=i),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),o(l,{label:"用户分成比列(%):",prop:"proportion",class:"w-full"},{default:r(()=>[o(a,{style:{width:"100%"},min:1,max:100,"controls-position":"right",modelValue:t(e).proportion,"onUpdate:modelValue":n[6]||(n[6]=i=>t(e).proportion=i),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),B("div",re,[o(g,{class:"w-[20%]",type:"info",onClick:n[7]||(n[7]=i=>C())},{default:r(()=>[y(" 取消 ")]),_:1}),o(g,{class:"w-[20%]",type:"success",loading:t(f),onClick:n[8]||(n[8]=i=>("throttle"in d?d.throttle:t(ae))(()=>{U(t(c))}))},{default:r(()=>[y(" 保存 ")]),_:1},8,["loading"])])]),_:1},8,["model","rules"])]),_:1},8,["model-value"])]),_:1})])}}});const ie=j(se,[["__scopeId","data-v-df43420b"]]),ue={class:"w-full h-[75vh] flex flex-col justify-between space-y-5"},pe={key:0,class:"flex items-center justify-end"},de={class:"flex justify-end"},me=A({__name:"index",props:{status:{default:1}},setup($){const u=$,p=x(!1),f=x({}),c=x(!1),_=k({content:[],status:0}),e=k({page:1,limit:20,status:u.status,asc:1}),v=async()=>{try{c.value=!0,u.status==1?e.asc=0:e.asc=1;const a=await le(e);c.value=!1,a.code===200?(_.content=a.data,_.totalElements=a.total):(_.content=[],_.totalElements=0,T({message:a.msg,grouping:!0,type:"error"}))}catch{c.value=!1}},U=a=>{e.page=a,v()},C=a=>(a/3600).toFixed(1),D=a=>{e.limit=a,v()},d=a=>{p.value=!0,f.value=a},n=a=>{const l=new Date(a*1e3);return`${l.getFullYear()}-${(l.getMonth()+1).toString().padStart(2,"0")}-${l.getDate().toString().padStart(2,"0")} ${l.getHours().toString().padStart(2,"0")}:${l.getMinutes().toString().padStart(2,"0")}:${l.getSeconds().toString().padStart(2,"0")}`};return R(()=>{v()}),(a,l)=>{const g=z,m=H,E=X,F=Y,i=J,I=ie,L=K;return w(),S("div",ue,[u.status==0?(w(),S("div",pe,[o(g,{class:"w-[100px]",type:"success",onClick:l[0]||(l[0]=s=>d(null))},{default:r(()=>[y(" 创建 ")]),_:1})])):V("",!0),G((w(),h(F,{ref:"multipleTableRef",class:"w-full flex-1",data:t(_).content,border:""},{default:r(()=>[o(m,{label:"纪元-时代",align:"center"},{default:r(s=>[y(" Epoch "+b(s.row.epoch_id)+" Age "+b(s.row.phase_id)+" ("+b(C(s.row.duration))+"h) ",1)]),_:1}),o(m,{label:"底价(USD)",prop:"price",align:"center"},{default:r(s=>[y(b(parseFloat((s.row.price/1e6).toFixed(2)))+"U ",1)]),_:1}),o(m,{label:"底仓(USD)",prop:"putmoney",align:"center"},{default:r(s=>[y(b(parseFloat((s.row.putmoney/1e6).toFixed(2)))+"U ",1)]),_:1}),o(m,{label:"底仓(BOX)",prop:"putbox",align:"center"}),o(m,{label:"底仓(SOUL)",prop:"putsoul",align:"center"}),o(m,{label:"用户分成比列(%)",prop:"proportion",align:"center"}),o(m,{prop:"eliminated",label:"淘汰",align:"center"},{default:r(s=>[y(b(("batType"in a?a.batType:t(q))(s.row.eliminated)[0]),1)]),_:1}),o(m,{prop:"mainstream",label:"进化",align:"center"},{default:r(s=>[y(b(("batType"in a?a.batType:t(q))(s.row.mainstream)[0]),1)]),_:1}),u.status==1?(w(),h(m,{key:0,label:"开始时间~结束时间",align:"center","show-overflow-tooltip":""},{default:r(s=>[y(b(n(s.row.timestamp))+" ~ "+b(n(s.row.timestamp+s.row.duration)),1)]),_:1})):V("",!0),u.status==0?(w(),h(m,{key:1,label:"操作",align:"center"},{default:r(s=>[o(E,{type:"success",onClick:ge=>d(s.row)},{default:r(()=>[y("编辑")]),_:2},1032,["onClick"])]),_:1})):V("",!0)]),_:1},8,["data"])),[[L,t(c)]]),B("div",de,[o(i,{"current-page":t(e).page,"onUpdate:currentPage":l[1]||(l[1]=s=>t(e).page=s),"page-size":t(e).limit,"onUpdate:pageSize":l[2]||(l[2]=s=>t(e).limit=s),"page-sizes":[20,50,100,500,1e3],layout:"total, sizes, prev, pager, next, jumper",total:t(_).totalElements,onCurrentChange:U,onSizeChange:D},null,8,["current-page","page-size","total"])]),o(I,{"dialog-visible":t(p),"onUpdate:closeDialog":l[3]||(l[3]=s=>p.value=!1),"onUpdate:success":l[4]||(l[4]=s=>v()),item:t(f)},null,8,["dialog-visible","item"])])}}});const ce=j(me,[["__scopeId","data-v-cd1c09e7"]]),_e={class:"w-full h-full text-[#EBEBEB] pt-10 px-5"},ze=A({__name:"deep-cycle",setup($){x(!1);const u=x("1");return(p,f)=>{const c=ce,_=W,e=Z;return w(),S("div",_e,[o(e,{modelValue:t(u),"onUpdate:modelValue":f[0]||(f[0]=v=>Q(u)?u.value=v:null),class:"w-full h-full"},{default:r(()=>[o(_,{label:"进行中",name:"1"},{default:r(()=>[t(u)=="1"?(w(),h(c,{key:0,status:t(u)},null,8,["status"])):V("",!0)]),_:1}),o(_,{label:"未开始",name:"0"},{default:r(()=>[t(u)=="0"?(w(),h(c,{key:0,status:t(u)},null,8,["status"])):V("",!0)]),_:1})]),_:1},8,["modelValue"])])}}});export{ze as default};
