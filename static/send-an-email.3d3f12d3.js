import{d as P,r as u,U as B,R as k,n as $,H as E,V as H,E as h,o as b,c as C,f as r,w as i,b as p,u as t,W as O,q as R,X as F,Y as N,p as T,a as q,_ as z,e as I,v as j,g as A,h as D,i as M,k as J,l as W}from"./entry.10915f71.js";import{_ as K}from"./client-only.bff9ef05.js";import{i as S}from"./index.a0298ae1.js";/* empty css                 *//* empty css                *//* empty css                  */import{M as L}from"./adminManage.64a87747.js";import{t as X}from"./throttle.46d02480.js";import"./request.aee2d5ca.js";const Y=c=>(T("data-v-bf2f889c"),c=c(),q(),c),G={key:0,class:"bg-black fixed inset-0 z-[99999999] overflow-scroll w-full h-full flex justify-center items-center px-6 py-4"},Q=["src"],Z=Y(()=>p("span",{class:"w-full h-full flex justify-center items-center text-white"},[p("span",{class:"iconfont icon-error text-2xl font-bold"})],-1)),ee=[Z],te=P({__name:"wangEditor",props:{txtHtml:{default:""},defaulTxtHtml:{default:""},isReadOnly:{type:Boolean,default:!0},isShowBorder:{type:Boolean,default:!1}},emits:["update:html-data"],setup(c,{emit:d}){const s=c,_=u(null),e=u(null),y=B(),m=u();return k(()=>s.txtHtml,o=>{S(e.value)||e.value.txt.html(o)},{deep:!0}),k(()=>s.isReadOnly,o=>{S(e.value)||e.value.$textElem.attr("contenteditable",o)},{deep:!0}),$(async()=>{await E(),H(()=>import("./wangEditor.dd24bf81.js").then(o=>o.w),["./wangEditor.dd24bf81.js","./entry.10915f71.js","./entry.de5e7d33.css"],import.meta.url).then(o=>{e.value=new o.default(_.value),e.value.customConfig=e.value.customConfig?e.value.customConfig:e.value.config,e.value.customConfig.menus=s.isReadOnly?["head","bold","fontSize","fontName","italic","underline","strikeThrough","foreColor","backColor","list","justify","quote","emoticon","table","undo","redo"]:[],e.value.config.uploadImgHeaders={Authorization:`Bearer ${y.getToken}`},e.value.customConfig.uploadFileName="file",e.value.customConfig.uploadImgServer="/api/file/upload",e.value.customConfig.uploadImgHooks={success:function(a,g,l){},fail:function(){h({message:"Upload successful, insertion failed",grouping:!0,type:"error"})},error:function(){h({message:"Upload failed, please retry",grouping:!0,type:"error"})},timeout:function(){h({message:"Upload timeout!",grouping:!0,type:"error"})}},e.value.config.pasteIgnoreImg=!0,e.value.config.customUploadImg=async(a,g)=>{},e.value.create(JSON.parse(JSON.stringify(s.txtHtml))),e.value.$textElem.attr("contenteditable",s.isReadOnly),E(()=>{e.value.txt.html(s.txtHtml)}),e.value.config.onchange=a=>{d("update:html-data",a)},e.value.$textElem.on("click","img",function(a){a.stopPropagation(),m.value=a.target.getAttribute("src")})}).catch(o=>{})}),(o,a)=>{const g=K;return b(),C("div",{class:N(["w-[50%] h-[350px]",{is_read_only:!o.$props.isReadOnly,is_show_border:o.isShowBorder}])},[r(g,null,{default:i(()=>[p("div",{ref_key:"editorEl",ref:_,class:"editorEl_box h-full flex flex-col justify-between"},null,512)]),_:1}),r(F,{name:"fade"},{default:i(()=>[t(m)?(b(),C("div",G,[p("img",{src:t(m),alt:"",class:"max-h-full object-cover"},null,8,Q),p("div",{class:"w-10 h-10 bg-red bg-opacity-80 rounded-full fixed z-20 top-12 right-12 cursor-pointer",onClick:a[0]||(a[0]=O(l=>m.value="",["stop"]))},ee)])):R("",!0)]),_:1})],2)}}});const oe=z(te,[["__scopeId","data-v-bf2f889c"]]),le={class:"h-[80vh] text-[#ebebeb] p-12 overflow-auto"},ae={class:"w-[65%] flex justify-center"},pe=P({__name:"send-an-email",setup(c){const d=u(!1),s=u(0),_=u(""),e=I({email:"",subject:"",content:""}),y=u(),m=I({email:[{required:!0,message:"Please enter",trigger:"blur"},{type:"email",message:"Please enter a valid email format",trigger:"blur"}],subject:[{required:!0,message:"Please enter",trigger:"blur"}],content:[{required:!0,message:"Please enter",trigger:"blur"}]}),o=l=>{e.content=l},a=l=>{l&&l.resetFields()},g=async l=>{l&&(d.value||await l.validate(async(n,w)=>{if(n)try{d.value=!0;const f={...e,subject:btoa(unescape(encodeURIComponent(e.subject))),content:btoa(unescape(encodeURIComponent(e.content)))},v=await L(f);v.code===200?h.success({message:v.data||"Sent successfully",grouping:!0,type:"success"}):h.error({message:v.msg,grouping:!0,type:"error"})}catch{}finally{d.value=!1,e.content="",_.value="",s.value+=1,a(l)}}))};return(l,n)=>{const w=D,f=M,v=oe,V=J,U=W;return b(),C("div",le,[r(U,{ref_key:"ruleFormRef",ref:y,class:"w-full",inline:!0,"label-position":"right","label-width":"140px",model:t(e),rules:t(m)},{default:i(()=>[t(e).id?R("",!0):(b(),j(f,{key:0,label:"Recipient:",prop:"email",class:"w-full"},{default:i(()=>[r(w,{style:{width:"50%"},modelValue:t(e).email,"onUpdate:modelValue":n[0]||(n[0]=x=>t(e).email=x),placeholder:"Please enter",clearable:""},null,8,["modelValue"])]),_:1})),r(f,{label:"Subject:",prop:"subject",class:"w-full"},{default:i(()=>[r(w,{style:{width:"50%"},modelValue:t(e).subject,"onUpdate:modelValue":n[1]||(n[1]=x=>t(e).subject=x),placeholder:"Please enter",clearable:"",type:"textarea"},null,8,["modelValue"])]),_:1}),r(f,{label:"Content:",prop:"content",class:"w-full"},{default:i(()=>[(b(),j(v,{key:t(s),"txt-html":t(_),"onUpdate:htmlData":o},null,8,["txt-html"]))]),_:1}),p("div",ae,[r(V,{class:"w-[20%]",type:"success",loading:t(d),onClick:n[2]||(n[2]=x=>("throttle"in l?l.throttle:t(X))(()=>{g(t(y))}))},{default:i(()=>[A(" Send ")]),_:1},8,["loading"])])]),_:1},8,["model","rules"])])}}});export{pe as default};
