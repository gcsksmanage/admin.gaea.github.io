import{d as z,r as C,e as T,o as v,c as F,f as l,w as n,b as A,y as _,u as o,x as k,D as V,g,h as q,k as G,j as R,l as N,m as M,n as H,_ as P,q as X,v as Y,I as J,z as K,N as Q,A as W,B as Z,C as ee,F as te,G as oe,H as le}from"./entry.ca22f7bd.js";import{_ as ae}from"./client-only.192d1b6b.js";/* empty css                        *//* empty css                 *//* empty css                *//* empty css                  *//* empty css                   */import{G as ne,P as j}from"./request.0c7932b7.js";import{l as L,b as I}from"./index.b2fe93da.js";import{t as se}from"./throttle.46d02480.js";/* empty css                 *//* empty css               *//* empty css                */import"./el-tooltip.4ed993c7.js";/* empty css                     *//* empty css                      *//* empty css                  *//* empty css                   *//* empty css                */const re=c=>ne(`/api/admin/choice/list?page=${c.page}&limit=${c.limit}&status=${c.status}&asc=${c.asc}`),ie=c=>j("/api/admin/choice/generate",c),ue=c=>j("/api/admin/choice/modify",c),pe={class:"text-[#ebebeb] text-[16px]"},de={class:"w-full flex justify-end"},me=z({__name:"Add",props:{dialogVisible:{type:Boolean,default:!1},item:{default:null}},emits:["update:closeDialog","update:success"],setup(c,{emit:i}){const p=c,w=C(!1),f=C(),b=T({number:[{required:!0,message:"请输入",trigger:"blur"}],putmoney:[{required:!0,message:"请输入",trigger:"blur"}],putbox:[{required:!0,message:"请输入",trigger:"blur"}],putsoul:[{required:!0,message:"请输入",trigger:"blur"}],price:[{required:!0,message:"请输入",trigger:"blur"}],duration:[{required:!0,message:"请输入",trigger:"blur"}],proportion:[{required:!0,message:"请输入",trigger:"blur"}]}),e=T({period_id:null,number:1,putmoney:100,putbox:500,putsoul:300,price:.36,duration:12,proportion:50}),x=m=>{m&&m.resetFields()},$=async m=>{m&&(w.value||await m.validate(async(r,y)=>{if(r)try{w.value=!0;const s={id:p.item.period_id,number:e.number,duration:e.duration*3600,price:e.price*1e6,putmoney:e.putmoney*1e6,proportion:e.proportion,putbox:e.putbox,putsoul:e.putsoul};var t=null;s.id?(delete s.number,t=await ue(s)):(delete s.id,t=await ie(s)),t.code===200?(q.success({message:"创建成功",grouping:!0,type:"success"}),i("update:success"),E()):q.error({message:t.msg,grouping:!0,type:"error"})}catch{}finally{w.value=!1,x(m)}}))},E=()=>{i("update:closeDialog"),x(f.value)},B=async()=>{p.item.period_id?(e.period_id=p.item.period_id,e.duration=p.item.duration/3600,e.price=p.item.price/1e6,e.putmoney=p.item.putmoney/1e6,e.proportion=p.item.proportion,e.putbox=p.item.putbox,e.putsoul=p.item.putsoul):(e.period_id=null,e.number=1,e.duration=24,e.price=.36,e.putmoney=100,e.proportion=50,e.putbox=500,e.putsoul=300)};return(m,r)=>{const y=G,t=R,s=N,h=M,d=H,U=ae;return v(),F("div",null,[l(U,null,{default:n(()=>[l(d,{draggable:"","model-value":m.$props.dialogVisible,style:{"background-color":"black",border:"1px  #ebebeb solid","border-radius":"10px","padding-bottom":"30px"},title:"",width:"500px",class:"px-10","align-center":"",onClose:E,onOpen:r[9]||(r[9]=D=>B())},{default:n(()=>{var D,S;return[A("p",pe,_(o(e).period_id?`编辑 Epoch ${(D=p.item)==null?void 0:D.epoch_id} - Age
                    ${("levelConversion"in m?m.levelConversion:o(L))((S=p.item)==null?void 0:S.epoch_id)}`:"新增抉择周期"),1),l(h,{ref_key:"ruleFormRef",ref:f,class:"w-full p-5",inline:!0,"label-position":"right","label-width":"140px",model:o(e),rules:o(b)},{default:n(()=>[o(e).period_id?V("",!0):(v(),k(t,{key:0,label:"数量:",prop:"number",class:"w-full"},{default:n(()=>[l(y,{style:{width:"100%"},min:1,max:200,"controls-position":"right",modelValue:o(e).number,"onUpdate:modelValue":r[0]||(r[0]=u=>o(e).number=u),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1})),l(t,{label:"时长(小时):",prop:"duration",class:"w-full"},{default:n(()=>[l(y,{style:{width:"100%"},"controls-position":"right",modelValue:o(e).duration,"onUpdate:modelValue":r[1]||(r[1]=u=>o(e).duration=u),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),l(t,{label:"底价(USD):",prop:"price",class:"w-full"},{default:n(()=>[l(y,{style:{width:"100%"},min:0,max:1e3,"controls-position":"right",modelValue:o(e).price,"onUpdate:modelValue":r[2]||(r[2]=u=>o(e).price=u),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),l(t,{label:"底仓:(USD)",prop:"putmoney",class:"w-full"},{default:n(()=>[l(y,{style:{width:"100%"},"controls-position":"right",modelValue:o(e).putmoney,"onUpdate:modelValue":r[3]||(r[3]=u=>o(e).putmoney=u),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),l(t,{label:"底仓:(BOX)",prop:"putbox",class:"w-full"},{default:n(()=>[l(y,{style:{width:"100%"},min:0,"controls-position":"right",modelValue:o(e).putbox,"onUpdate:modelValue":r[4]||(r[4]=u=>o(e).putbox=u),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),l(t,{label:"底仓:(SOUL)",prop:"putsoul",class:"w-full"},{default:n(()=>[l(y,{style:{width:"100%"},min:0,"controls-position":"right",modelValue:o(e).putsoul,"onUpdate:modelValue":r[5]||(r[5]=u=>o(e).putsoul=u),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),l(t,{label:"用户分成比列(%):",prop:"proportion",class:"w-full"},{default:n(()=>[l(y,{style:{width:"100%"},min:1,max:100,"controls-position":"right",modelValue:o(e).proportion,"onUpdate:modelValue":r[6]||(r[6]=u=>o(e).proportion=u),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),A("div",de,[l(s,{class:"w-[20%]",type:"info",onClick:r[7]||(r[7]=u=>E())},{default:n(()=>[g(" 取消 ")]),_:1}),l(s,{class:"w-[20%]",type:"success",loading:o(w),onClick:r[8]||(r[8]=u=>("throttle"in m?m.throttle:o(se))(()=>{$(o(f))}))},{default:n(()=>[g(" 保存 ")]),_:1},8,["loading"])])]),_:1},8,["model","rules"])]}),_:1},8,["model-value"])]),_:1})])}}});const ce=P(me,[["__scopeId","data-v-2ef1c276"]]),_e={class:"w-full h-[75vh] flex flex-col justify-between space-y-5"},ge={key:0,class:"flex items-center justify-end"},fe={class:"flex justify-end"},be=z({__name:"index",props:{status:{default:1}},setup(c){const i=c,p=C(!1),w=C({}),f=C(!1),b=T({content:[],status:0}),e=T({page:1,limit:20,status:i.status,asc:1}),x=t=>{const s=t.timestamp,h=t.timestamp+t.duration;return{start:r(s),end:r(h)}},$=async()=>{try{f.value=!0,i.status==1?e.asc=0:e.asc=1;const t=await re(e);f.value=!1,t.code===200?(b.content=t.data,b.totalElements=t.total):(b.content=[],b.totalElements=0,q({message:t.msg,grouping:!0,type:"error"}))}catch{f.value=!1}},E=t=>{e.page=t,$()},B=t=>(t/3600).toFixed(1),m=t=>{e.limit=t,$()},r=t=>{const s=new Date(t*1e3),h=s.getFullYear(),d=String(s.getMonth()+1).padStart(2,"0"),U=String(s.getDate()).padStart(2,"0");return`${h}-${d}-${U}`},y=t=>{p.value=!0,w.value=t};return X(()=>{$()}),(t,s)=>{const h=N,d=K,U=Q,D=W,S=Z,u=ce,O=ee;return v(),F("div",_e,[i.status==0?(v(),F("div",ge,[l(h,{class:"w-[100px]",type:"success",onClick:s[0]||(s[0]=a=>y({}))},{default:n(()=>[g(" 创建 ")]),_:1})])):V("",!0),Y((v(),k(D,{ref:"multipleTableRef",class:"w-full flex-1",data:o(b).content,border:""},{default:n(()=>[l(d,{label:"纪元-时代",align:"center"},{default:n(a=>[g(" Epoch "+_(a.row.epoch_id)+" - Age "+_(("levelConversion"in t?t.levelConversion:o(L))(a.row.phase_id))+" ("+_(B(a.row.duration))+"h) ",1)]),_:1}),l(d,{label:"底价(USD)",prop:"price",align:"center"},{default:n(a=>[g(_(parseFloat((a.row.price/1e6).toFixed(2)))+"U ",1)]),_:1}),l(d,{label:"底仓(USD)",prop:"putmoney",align:"center"},{default:n(a=>[g(_(parseFloat((a.row.putmoney/1e6).toFixed(2)))+"U ",1)]),_:1}),l(d,{label:"底仓(BOX)",prop:"putbox",align:"center"},{default:n(a=>[g(_(a.row.putbox||"-"),1)]),_:1}),l(d,{label:"底仓(SOUL)",prop:"putsoul",align:"center"},{default:n(a=>[g(_(a.row.putsoul||"-"),1)]),_:1}),l(d,{label:"用户分成比列(%)",prop:"proportion",align:"center"}),i.status!=0?(v(),F(J,{key:0},[l(d,{label:"淘汰",prop:"price",align:"center"},{default:n(a=>[g(_(("batType"in t?t.batType:o(I))(a.row.eliminated)),1)]),_:1}),l(d,{label:"主流",prop:"price",align:"center"},{default:n(a=>[g(_(("batType"in t?t.batType:o(I))(a.row.mainstream)),1)]),_:1}),l(d,{label:"参与人数",prop:"user_total",align:"center"})],64)):V("",!0),i.status==1?(v(),k(d,{key:1,label:"开始时间~结束时间",align:"center","show-overflow-tooltip":""},{default:n(a=>[g(_(x(a.row).start)+"~"+_(x(a.row).end),1)]),_:1})):V("",!0),i.status==0?(v(),k(d,{key:2,label:"操作",align:"center"},{default:n(a=>[l(U,{type:"success",onClick:we=>y(a.row)},{default:n(()=>[g("编辑")]),_:2},1032,["onClick"])]),_:1})):V("",!0)]),_:1},8,["data"])),[[O,o(f)]]),A("div",fe,[l(S,{"current-page":o(e).page,"onUpdate:currentPage":s[1]||(s[1]=a=>o(e).page=a),"page-size":o(e).limit,"onUpdate:pageSize":s[2]||(s[2]=a=>o(e).limit=a),"page-sizes":[20,50,100,500,1e3],layout:"total, sizes, prev, pager, next, jumper",total:o(b).totalElements,onCurrentChange:E,onSizeChange:m},null,8,["current-page","page-size","total"])]),l(u,{"dialog-visible":o(p),"onUpdate:closeDialog":s[3]||(s[3]=a=>p.value=!1),"onUpdate:success":s[4]||(s[4]=a=>$()),item:o(w)},null,8,["dialog-visible","item"])])}}});const ye=P(be,[["__scopeId","data-v-79387c47"]]),ve={class:"w-full h-full text-[#EBEBEB] pt-10 px-5"},je=z({__name:"decision-cycle",setup(c){C(!1);const i=C("1");return(p,w)=>{const f=ye,b=oe,e=le;return v(),F("div",ve,[l(e,{modelValue:o(i),"onUpdate:modelValue":w[0]||(w[0]=x=>te(i)?i.value=x:null),class:"w-full h-full"},{default:n(()=>[l(b,{label:"进行中",name:"1"},{default:n(()=>[o(i)=="1"?(v(),k(f,{key:0,status:o(i)},null,8,["status"])):V("",!0)]),_:1}),l(b,{label:"未开始",name:"0"},{default:n(()=>[o(i)=="0"?(v(),k(f,{key:0,status:o(i)},null,8,["status"])):V("",!0)]),_:1})]),_:1},8,["modelValue"])])}}});export{je as default};
