import{T as N,U as F,d as j,V,W as J,r as C,q as O,S as Q,X as U,Y,Z,$ as ee,a0 as te,a1 as ae,a2 as le,e as A,o as T,c as B,f as s,w as d,b as L,g as x,y as S,u as p,I as ne,J as oe,x as $,E as M,h as E,L as re,K as se,j as ie,m as ce,l as H,n as ue,_ as de,s as pe,v as fe,z as me,a3 as ge,M as ve,A as _e,B as he,C as be,D as z,F as ye,G as xe,H as we}from"./entry.aea1d2a1.js";import{_ as ke}from"./client-only.4d4fe75a.js";/* empty css                  *//* empty css                 *//* empty css               *//* empty css                     *//* empty css                *//* empty css                  *//* empty css                   *//* empty css                       */import{v as K,x as Ce}from"./adminManage.827e651c.js";import{t as Te}from"./throttle.46d02480.js";/* empty css                 *//* empty css                   */import"./el-tooltip.4ed993c7.js";/* empty css                      *//* empty css                   */import{s as Ee}from"./index.ee23882a.js";/* empty css                */import"./request.f0224604.js";const I=globalThis.requestIdleCallback||(o=>{const l=Date.now(),g={didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-l))};return setTimeout(()=>{o(g)},1)}),Re=globalThis.cancelIdleCallback||(o=>{clearTimeout(o)}),Se=o=>{const l=N();l.isHydrating?l.hooks.hookOnce("app:suspense:resolve",()=>{I(o)}):I(o)};async function W(o,l=F()){const{path:g,matched:e}=l.resolve(o);if(!e.length||(l._routePreloaded||(l._routePreloaded=new Set),l._routePreloaded.has(g)))return;const r=l._preloadPromises=l._preloadPromises||[];if(r.length>4)return Promise.all(r).then(()=>W(o,l));l._routePreloaded.add(g);const u=e.map(a=>{var v;return(v=a.components)==null?void 0:v.default}).filter(a=>typeof a=="function");for(const a of u){const v=Promise.resolve(a()).catch(()=>{}).finally(()=>r.splice(r.indexOf(v)));r.push(v)}await Promise.all(r)}const Le=(...o)=>o.find(l=>l!==void 0),Pe="noopener noreferrer";/*! @__NO_SIDE_EFFECTS__ */function Ae(o){const l=o.componentName||"NuxtLink",g=(e,r)=>{if(!e||o.trailingSlash!=="append"&&o.trailingSlash!=="remove")return e;const u=o.trailingSlash==="append"?te:ae;if(typeof e=="string")return u(e,!0);const a="path"in e?e.path:r(e).path;return{...e,name:void 0,path:u(a,!0)}};return j({name:l,props:{to:{type:[String,Object],default:void 0,required:!1},href:{type:[String,Object],default:void 0,required:!1},target:{type:String,default:void 0,required:!1},rel:{type:String,default:void 0,required:!1},noRel:{type:Boolean,default:void 0,required:!1},prefetch:{type:Boolean,default:void 0,required:!1},noPrefetch:{type:Boolean,default:void 0,required:!1},activeClass:{type:String,default:void 0,required:!1},exactActiveClass:{type:String,default:void 0,required:!1},prefetchedClass:{type:String,default:void 0,required:!1},replace:{type:Boolean,default:void 0,required:!1},ariaCurrentValue:{type:String,default:void 0,required:!1},external:{type:Boolean,default:void 0,required:!1},custom:{type:Boolean,default:void 0,required:!1}},setup(e,{slots:r}){const u=F(),a=V(()=>{const m=e.to||e.href||"";return g(m,u.resolve)}),v=V(()=>e.external||e.target&&e.target!=="_self"?!0:typeof a.value=="object"?!1:a.value===""||J(a.value,{acceptRelative:!0})),w=C(!1),_=C(null),k=m=>{var f;_.value=e.custom?(f=m==null?void 0:m.$el)==null?void 0:f.nextElementSibling:m==null?void 0:m.$el};if(e.prefetch!==!1&&e.noPrefetch!==!0&&e.target!=="_blank"&&!je()){const f=N();let t,n=null;O(()=>{const i=$e();Se(()=>{t=I(()=>{var b;(b=_==null?void 0:_.value)!=null&&b.tagName&&(n=i.observe(_.value,async()=>{n==null||n(),n=null;const h=typeof a.value=="string"?a.value:u.resolve(a.value).fullPath;await Promise.all([f.hooks.callHook("link:prefetch",h).catch(()=>{}),!v.value&&W(a.value,u).catch(()=>{})]),w.value=!0}))})})}),Q(()=>{t&&Re(t),n==null||n(),n=null})}return()=>{var i,b;if(!v.value){const h={ref:k,to:a.value,activeClass:e.activeClass||o.activeClass,exactActiveClass:e.exactActiveClass||o.exactActiveClass,replace:e.replace,ariaCurrentValue:e.ariaCurrentValue,custom:e.custom};return e.custom||(w.value&&(h.class=e.prefetchedClass||o.prefetchedClass),h.rel=e.rel),U(Y("RouterLink"),h,r.default)}const m=typeof a.value=="object"?((i=u.resolve(a.value))==null?void 0:i.href)??null:a.value||null,f=e.target||null,t=e.noRel?null:Le(e.rel,o.externalRelAttribute,m?Pe:"")||null,n=()=>le(m,{replace:e.replace});return e.custom?r.default?r.default({href:m,navigate:n,get route(){if(!m)return;const h=Z(m);return{path:h.pathname,fullPath:h.pathname,get query(){return ee(h.search)},hash:h.hash,params:{},name:void 0,matched:[],redirectedFrom:void 0,meta:{},href:m}},rel:t,target:f,isExternal:v.value,isActive:!1,isExactActive:!1}):null:U("a",{ref:_,href:m,rel:t,target:f},(b=r.default)==null?void 0:b.call(r))}}})}const Be=Ae({componentName:"NuxtLink"});function $e(){const o=N();if(o._observer)return o._observer;let l=null;const g=new Map,e=(u,a)=>(l||(l=new IntersectionObserver(v=>{for(const w of v){const _=g.get(w.target);(w.isIntersecting||w.intersectionRatio>0)&&_&&_()}})),g.set(u,a),l.observe(u),()=>{g.delete(u),l.unobserve(u),g.size===0&&(l.disconnect(),l=null)});return o._observer={observe:e}}function je(){const o=navigator.connection;return!!(o&&(o.saveData||/2g/.test(o.effectiveType)))}const qe={class:"text-[#ebebeb] text-[16px] mb-5"},De={class:"text-red-500"},Ie={class:"w-full flex justify-end mt-5"},Ne=j({__name:"Reject",props:{dialogVisible:{type:Boolean,default:!1},item:{default:""}},emits:["update:closeDialog","update:success"],setup(o,{emit:l}){const g=o,e=C(),r=C(!1),u=C([{value:"Repetitive or overly similar content"},{value:"Low view count"},{value:"Contains prohibited content (e.g., ads, sensitive information, etc.)"},{value:"Fails to reflect GAEA-related topics or value"},{value:"Invalid or missing images/links"},{value:"The uploaded Discord account does not match the one that is linked."},{value:"Empty text or uploaded file is blank"},{value:"Incomplete task submission"},{value:"Use of auto-generated or non-original content"},{value:"Unclear or vague language expression"}]),a=A({reason:""}),v=f=>/^[^\u4e00-\u9fa5]*$/.test(f)&&f.length<=128,w=A({reason:[{required:!0,message:"驳回原因为必填项",trigger:"change"},{validator:(f,t,n)=>{t&&!v(t)?n(new Error("仅限英文内容，且长度不得超过128字符")):n()},trigger:"blur"}]}),_=()=>{l("update:closeDialog"),a.reason=""},k=f=>{a.reason=f.target.value},m=async f=>{f&&await f.validate(async(t,n)=>{t&&M.confirm(`驳回用户名为：${g.item.username} 的申请`,"Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{try{r.value=!0;const i=await K({id:g.item.id,status:-2,reason:a.reason});i.code===200?(E.success(i.data),l("update:success"),_()):E.error(i.msg)}catch{}finally{r.value=!1}}).catch(()=>{E({type:"info",message:"canceled"})})})};return(f,t)=>{const n=re,i=se,b=ie,h=ce,P=H,R=ue,q=ke;return T(),B("div",null,[s(q,null,{default:d(()=>[s(R,{draggable:"","model-value":f.$props.dialogVisible,style:{"background-color":"black",border:"1px  #ebebeb solid","border-radius":"10px","padding-bottom":"30px"},title:"",width:"550px",class:"px-10","align-center":"",onClose:_},{default:d(()=>[L("p",qe,[x("驳回用户名为："),L("span",De,S(g.item.username),1),x(" 的申请")]),s(h,{ref_key:"ruleFormRef",ref:e,class:"w-full p-5",inline:!0,"label-position":"right","label-width":"70px",model:p(a),rules:p(w)},{default:d(()=>[s(b,{label:"数量:",prop:"reason",class:"w-full"},{default:d(()=>[s(i,{modelValue:p(a).reason,"onUpdate:modelValue":t[0]||(t[0]=y=>p(a).reason=y),clearable:"",filterable:"","allow-create":"","default-first-option":"",onInput:t[1]||(t[1]=y=>k(y)),"reserve-keyword":!1,placeholder:"请选择驳回原因",style:{height:"32px","border-radius":"50px",width:"250px"}},{default:d(()=>[(T(!0),B(ne,null,oe(p(u),(y,D)=>(T(),$(n,{key:y.value,label:`${D+1}.${y.value}`,value:y.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),L("div",Ie,[s(P,{class:"w-[20%]",type:"info",onClick:t[2]||(t[2]=y=>_())},{default:d(()=>[x(" 取消 ")]),_:1}),s(P,{loading:p(r),class:"w-[20%]",type:"danger",onClick:t[3]||(t[3]=y=>("throttle"in f?f.throttle:p(Te))(()=>{m(p(e))}))},{default:d(()=>[x(" 驳回 ")]),_:1},8,["loading"])])]),_:1},8,["model-value"])]),_:1})])}}});const Ve=de(Ne,[["__scopeId","data-v-3c684eee"]]),Ue={class:"w-full h-full flex flex-col space-y-2 p-6"},ze={class:"w-full flex-1 overflow-y-auto"},Fe={class:"flex justify-end"},Oe=j({__name:"Index",props:{level:{default:""}},setup(o){const l=o,g=C(),e=C(!1),r=C(!1),u=A({content:[],totalElements:0}),a=A({level:Number(l.level),page:1,limit:20}),v=t=>{a.page=t,k()},w=t=>{a.limit=t,k()},_=t=>{const b=new URL(t).pathname.split("_");return b[b.length-1]},k=async()=>{try{r.value=!0;const t={...a},n=await Ce(t);r.value=!1,n.code&&(u.content=n.data.map(i=>({...i,passThroughLoading:!1,rejectLoading:!1})))}catch{r.value=!1}finally{r.value=!1}},m=t=>{M.confirm(`通过用户名为：${t.username} 的申请`,"Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{try{t.passThroughLoading=!0;const n=await K({id:t.id,status:2,reason:""});t.passThroughLoading=!1,n.code===200?(E.success(n.data),k()):E.error(n.msg)}catch{}finally{t.passThroughLoading=!1}}).catch(()=>{E({type:"info",message:"canceled"})})},f=t=>{g.value=t,e.value=!0};return O(async()=>{await pe(),k()}),(t,n)=>{const i=me,b=ge,h=Be,P=ve,R=H,q=_e,y=he,D=Ve,X=be;return T(),B("div",Ue,[L("div",ze,[fe((T(),$(q,{ref:"multipleTableRef",height:"600px",data:p(u).content,border:"",style:{height:"100%"},"header-cell-style":{background:"#e0eeee"}},{default:d(()=>[s(i,{prop:"userid",label:"用户ID",align:"center",width:"140px",sortable:""}),s(i,{prop:"username",label:"用户名",align:"center",width:"150px","show-overflow-tooltip":"",sortable:""}),s(i,{prop:"created_time",label:"上传时间",align:"center",width:"150px",sortable:"","show-overflow-tooltip":""}),s(i,{prop:"type",label:"勋章",align:"center",sortable:""},{default:d(c=>[s(b,{type:c.row.type===1?"success":c.row.type===2?"warning":"danger",size:"small",effect:"dark"},{default:d(()=>[x(S(c.row.type===1?"一级":c.row.type===2?"二级":"三级"),1)]),_:2},1032,["type"])]),_:1}),s(i,{prop:"medal_id",label:"任务id",align:"center","min-width":"100px",sortable:""}),s(i,{prop:"code",label:"任务代号",align:"center","min-width":"120px",sortable:""}),s(i,{prop:"social_x_name",label:"社交X名称",align:"center","min-width":"130px","show-overflow-tooltip":""},{default:d(c=>[x(S(c.row.social_x_name||"未绑定"),1)]),_:1}),s(i,{prop:"social_dc_name",label:"Discord名称",align:"center","min-width":"140px","show-overflow-tooltip":""},{default:d(c=>[x(S(c.row.social_dc_name||"未绑定"),1)]),_:1}),s(i,{prop:"url",label:"文件",align:"center",width:"150","show-overflow-tooltip":""},{default:d(c=>[s(P,{class:"box-item",title:"",content:`${_(c.row.url)}`,placement:"top-start"},{reference:d(()=>[s(h,{to:c.row.url,target:"_blank",rel:"noopener",class:"hover:underline underline-offset-4 u-line-1"},{default:d(()=>[x(S(("stringStar"in t?t.stringStar:p(Ee))({value:_(c.row.url),characters:"***",start:4,end:7})),1)]),_:2},1032,["to"])]),_:2},1032,["content"])]),_:1}),s(i,{label:"操作",width:"320",fixed:"right",align:"center"},{default:d(c=>[s(h,{to:c.row.url,target:"_blank",rel:"noopener",class:"mr-3"},{default:d(()=>[s(R,{type:"primary"},{default:d(()=>[x("查看")]),_:1})]),_:2},1032,["to"]),s(R,{type:"success",loading:c.row.passThroughLoading,onClick:G=>m(c.row)},{default:d(()=>[x("通过")]),_:2},1032,["loading","onClick"]),s(R,{type:"danger",loading:c.row.rejectLoading,onClick:G=>f(c.row)},{default:d(()=>[x("驳回")]),_:2},1032,["loading","onClick"])]),_:1})]),_:1},8,["data"])),[[X,p(r)]]),L("div",Fe,[s(y,{"current-page":p(a).page,"onUpdate:currentPage":n[0]||(n[0]=c=>p(a).page=c),"page-size":p(a).limit,"onUpdate:pageSize":n[1]||(n[1]=c=>p(a).limit=c),"page-sizes":[20,50,100,500,1e3],layout:"total, sizes, prev, pager, next, jumper",total:p(u).totalElements,onCurrentChange:v,onSizeChange:w},null,8,["current-page","page-size","total"])])]),s(D,{"dialog-visible":p(e),"onUpdate:closeDialog":n[2]||(n[2]=c=>e.value=!1),item:p(g),"onUpdate:success":n[3]||(n[3]=c=>k())},null,8,["dialog-visible","item"])])}}}),Me={class:"w-full h-full flex flex-col space-y-2 p-6"},dt=j({__name:"task-audit",setup(o){const l=C("2");return(g,e)=>{const r=Oe,u=xe,a=we;return T(),B("div",Me,[s(a,{modelValue:p(l),"onUpdate:modelValue":e[0]||(e[0]=v=>ye(l)?l.value=v:null),class:"w-full h-full bg-black"},{default:d(()=>[s(u,{label:"等级2",name:"2"},{default:d(()=>[p(l)=="2"?(T(),$(r,{key:0,level:p(l)},null,8,["level"])):z("",!0)]),_:1}),s(u,{label:"等级3",name:"3"},{default:d(()=>[p(l)=="3"?(T(),$(r,{key:0,level:p(l)},null,8,["level"])):z("",!0)]),_:1})]),_:1},8,["modelValue"])])}}});export{dt as default};
