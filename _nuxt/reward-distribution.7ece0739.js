import{d as D,r as v,e as k,K as $,o as y,c as x,f as a,w as n,u as o,Q as F,R as I,g as b,y as N,b as T,h as _,i as q,j as A,L as C,M as U,k as j,l as L,m as M,_ as E}from"./entry.0ba19b1b.js";/* empty css                 */import{t as P}from"./throttle.1d0e35fd.js";/* empty css                       *//* empty css                        *//* empty css                  */import{o as S,p as G,q as K,r as Q}from"./adminManage.52619c96.js";import"./request.b1438f49.js";const z={class:"w-fit text-[#EBEBEB] pl-10"},H={class:"w-full flex justify-end"},J=D({__name:"DistributeRewards",setup(R){const p=v(),d=[{value:"points",key:"points",label:"积分",api:S,min:1,max:1e4},{value:"soul",key:"soul",label:"心灵点",api:G,min:1,max:500},{value:"number",key:"blindbox",label:"盲盒",api:K,min:1,max:200},{value:"number",key:"ticketbox",label:"票盒",api:Q,min:1,max:200}],V=k({uids:[{required:!0,message:"请输入用户ID",trigger:"blur"},{max:16,message:"用户ID长度不能超过14个字符",trigger:"blur"}],num:[{required:!0,message:"请输入",trigger:"blur"},{validator:(r,t,i)=>{const e=d.find(u=>u.key===l.type);e&&(t<e.min||t>e.max)?i(new Error(`${e.label}数应在 ${e.min} 到 ${e.max} 之间`)):i()},trigger:"blur"}],type:[{required:!0,message:"请选择奖励类型",trigger:"change"}]}),m=v(!1),l=k({uids:"",type:"points",num:1,points:null,soul:null,blindbox:null,ticketbox:null,description:""});$(()=>l.type,r=>{r!==void 0&&(l.num=1)});const g=r=>{r&&r.resetFields()},B=async r=>{r&&(m.value||await r.validate(async(t,i)=>{if(t)try{const e=d.find(f=>f.key===l.type);if(!e){_.error("未找到对应的奖励类型");return}const u={uids:l.uids,[e.value]:Number(l.num)};console.log(u,"payload"),m.value=!0;const c=await e.api(u);c.code===200?_.success(`${e.label}奖励发放成功`):_.error(c.msg||"奖励发放失败")}catch(e){console.error(e),_.error("奖励发放失败，请稍后再试")}finally{m.value=!1,g(r)}}))};return(r,t)=>{const i=q,e=A,u=C,c=U,f=j,w=L,h=M;return y(),x("div",z,[a(h,{ref_key:"ruleFormRef",ref:p,inline:!0,"label-position":"right","label-width":"90px",model:o(l),rules:o(V),class:"flex flex-col w-fit"},{default:n(()=>[a(e,{label:"用户ID:",prop:"uids",class:"w-[270px]"},{default:n(()=>[a(i,{modelValue:o(l).uids,"onUpdate:modelValue":t[0]||(t[0]=s=>o(l).uids=s),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),a(e,{label:"奖励:",prop:"type"},{default:n(()=>[a(c,{modelValue:o(l).type,"onUpdate:modelValue":t[1]||(t[1]=s=>o(l).type=s)},{default:n(()=>[(y(),x(F,null,I(d,(s,Z)=>a(u,{label:s.key,key:s.key},{default:n(()=>[b(N(s.label),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),a(e,{label:"数量:",prop:"num",class:"w-[350px]"},{default:n(()=>[a(f,{min:1,max:1e4,"controls-position":"right",modelValue:o(l).num,"onUpdate:modelValue":t[2]||(t[2]=s=>o(l).num=s),placeholder:"请输入",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),T("div",H,[a(w,{class:"w-[20%]",type:"danger",onClick:t[3]||(t[3]=s=>g(o(p)))},{default:n(()=>[b(" 重置 ")]),_:1}),a(w,{class:"w-[20%]",type:"success",loading:o(m),onClick:t[4]||(t[4]=s=>("throttle"in r?r.throttle:o(P))(()=>{B(o(p))}))},{default:n(()=>[b(" 发放 ")]),_:1},8,["loading"])])]),_:1},8,["model","rules"])])}}});const O=E(J,[["__scopeId","data-v-16f59eb8"]]),W={},X={class:"w-full text-[#EBEBEB] pt-10"};function Y(R,p){const d=O;return y(),x("div",X,[a(d)])}const ie=E(W,[["render",Y]]);export{ie as default};
